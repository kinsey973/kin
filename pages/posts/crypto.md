---
title: crypto
date: 2024-06-08 17:00:57
tags: 
     - crypto
     - é¢˜è§£
categories: å¯†ç ç¬”è®°
sticky: 100
---

### æ•°è®º

#### [ç½‘é¼æ¯ 2020 é’é¾™ç»„]you_raise_me_upï¼ˆå¤§æ­¥å°æ­¥ç®—æ³•ï¼‰

é¦–å…ˆï¼Œæˆ‘ä»¬å®¡è®¡é¢˜ç›®ï¼Œå¯ä»¥å‘ç°é¢˜ç›®ä¸­ç»™äºˆäº†æˆ‘ä»¬mã€cå’Œnçš„å€¼ï¼Œå…¶ä¸­n=2\**512,måˆ™æ˜¯åœ¨ï¼ˆ2ï¼Œmï¼‰ä¹‹é—´çš„å€¼ï¼Œcæ˜¯m^flag = c mod n

å¯ä»¥çœ‹å‡ºï¼Œè¿™æ˜¯ä¸€é“æ±‚æŒ‡æ ‡çš„é¢˜ç›®ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹æ³•è¿›è¡Œè®¡ç®—ï¼Œå·²çŸ¥çš„æ¡ä»¶ä¸ºï¼š

2^e = c1 mod n   åœ¨è¿™å…¶ä¸­ï¼Œé™¤äº†eå…¶ä½™æ¡ä»¶æˆ‘ä»¬éƒ½å·²çŸ¥ï¼Œåœ¨è¿™é‡Œï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨ç¦»æ•£å¯¹æ•°æ±‚è§£çš„æ€è·¯ï¼š

> Shanksâ€™s Babystep-Giantstep Algorithmç®—æ³•ï¼š
> 1ã€n=[ âˆšn ]+1
>
> 2ã€æ„é€ ä¸¤ä¸ªåˆ—è¡¨
>
>   list1=[1,g,g^2,g^3,......,g^n]
>
>   list2=[h,hg^(-n),hg^(-2n),......,hg^(-n**2)]
>
> 3ã€åœ¨ä¸¤ä¸ªåˆ—è¡¨ä¸­ï¼Œæ‰¾åˆ°ä¸¤ä¸ªç›¸åŒçš„æ•° g^i=hg^(-jn)
>
> =>g^(i+jn)=h mod n
>
> 4ã€æˆ‘ä»¬æ‰€æ±‚çš„e=i+jn
> pythonåº“åº”ç”¨ï¼š
>
> python(sympyåº“)  x=sympy.discrete_log(n,a,g)
> 

exp

```
m = 391190709124527428959489662565274039318305952172936859403855079581402770986890308469084735451207885386318986881041563704825943945069343345307381099559075
c = 6665851394203214245856789450723658632520816791621796775909766895233000234023642878786025644953797995373211308485605397024123180085924117610802485972584499
n=2**512
 
 
import gmpy2
from Crypto.Util.number import *
import sympy
x=sympy.discrete_log(n,c,m)
print(long_to_bytes(x))
```

#### æ•‘ä¸–æ·å¾„ï¼ˆdijstraç®—æ³•ï¼‰

è¿™é“é¢˜æ„Ÿè§‰è·Ÿacmçš„å¯»æ‰¾æœ€çŸ­è·¯å¾„ä¸€æ ·.

txtæ–‡ä»¶ä¸­æ¯è¡Œçš„å‰ä¸¤ä¸ªæ•°å­—ä½œä¸ºæ— å‘å›¾çš„é¡¶ç‚¹ï¼Œç¬¬ä¸‰ä¸ªæ•°å­—æ˜¯ä¸¤é¡¶ç‚¹ä¹‹é—´çš„è·ç¦»ï¼Œæœ€åçš„å­—ç¬¦ä¸²æ˜¯ä¸¤é¡¶ç‚¹ä¹‹é—´çš„å†…å®¹ï¼Œå°†èµ·ç‚¹åˆ°ç»ˆç‚¹æœ€çŸ­è·¯å¾„ç»è¿‡çš„è¾¹ä¸Šçš„å†…å®¹ç»„åˆèµ·æ¥ä¾¿æ˜¯flagã€‚
å•æºç‚¹æœ€çŸ­è·¯å¾„ç®—æ³•ï¼šdijstraç®—æ³•ã€‚
ä¸€äº›æƒ³åˆ°å“ªæ˜¯å“ªçš„tipså†™åœ¨è¿™é‡Œå’¯ï¼š

**1.ä¸€äº›å‰æœŸçš„åˆå§‹åŒ–å’Œæ•°æ®å¤„ç†**

1ï¼‰åˆå§‹åŒ–å„ç‚¹ä¹‹é—´çš„è·ç¦»ä¸ºâ€œæ— ç©·è¿œâ€ï¼ˆåœ¨ç¨‹åºä¸­ç”¨ä¸€ä¸ªæ¯”è¾ƒå¤§çš„æ•°ä»£æ›¿è¿™ä¸ªæ— ç©·è¿œçš„æ¦‚å¿µï¼‰ï¼Œä¸€èˆ¬å¯ä»¥ç›´è§‚åœ°æƒ³å‡ºç”¨27\*27çš„äºŒç»´æ•°ç»„å­˜è¿™äº›è·ç¦»å€¼ï¼ˆPythonä¸­æ˜¯ç”¨listå¥—listä½œä¸ºè¿‡å»é«˜çº§è¯­è¨€ä¸­äºŒç»´æ•°ç»„çš„é‚£ç§å­˜åœ¨â€¦â€¦è€Œä¸”è¦æ³¨æ„è¦åˆå§‹åŒ–æŠŠlisté‡Œé¢éƒ½æ”¾ä¸Šä¸œè¥¿æ‰è¡Œï¼ï¼‰ï¼Œä¹‹åæˆ‘ä»¬å°±æ“ä½œç´¢å¼•æ˜¯1-26çš„é‚£äº›å…ƒç´ ï¼Œæµªè´¹æ‰ä½ç½®0å¤„çš„ç©ºé—´ï¼Œä½†å¯ä»¥æ°å¥½å¯¹åº”é¡¶ç‚¹1-26ï¼Œæ¸…æ™°æ˜äº†~

2ï¼‰æŒ‰è¡Œè¯»å–é¢˜ç›®txtæ–‡ä»¶ä¸­çš„å†…å®¹ï¼Œç”¨çš„æ˜¯readlines()ï¼Œå¾—åˆ°çš„æ•°æ®å½¢å¼æ˜¯æ¯è¡Œä½œä¸ºä¸€ä¸ªå…ƒç´ ç»„æˆçš„listã€‚ç„¶åç”¨strip()å»æ‰è¡Œå°¾çš„æ¢è¡Œç¬¦â€™\nâ€™ï¼Œå†ç”¨split(â€™ ')å°†æ¯è¡Œå†…å®¹æŒ‰ç©ºæ ¼åˆ†å‰²ç»„æˆæ–°çš„listï¼Œæ–¹ä¾¿åé¢åœ¨ç¨‹åºä¸­çš„è°ƒç”¨ã€‚

3ï¼‰å› ä¸ºåœ¨2ï¼‰æ­¥ä¸­å·²ç»åˆ†å‰²å‡ºäº†æ¯è¡Œçš„å…ƒç´ ï¼Œå°±å¯ä»¥ç”¨2ï¼‰æ­¥ä¸­çš„æ•°æ®å»åˆå§‹åŒ–1ï¼‰æ­¥ä¸­27*27çš„listä¸­çš„æ•°æ®ï¼ŒæŠŠå·²çŸ¥çš„é‚£äº›ä¸¤ç‚¹ä¹‹é—´çš„è·ç¦»æ”¾å…¥å³å¯ï¼Œå…·ä½“å†™æ³•è§ç¨‹åºä»£ç ã€‚

**2.å®ç°dijstraç®—æ³•çš„å‡½æ•°**

1ï¼‰åˆå§‹åŒ–ä¸€ä¸ªé•¿åº¦æ˜¯27ï¼Œå…ƒç´ å…¨æ˜¯0xffffï¼ˆä»£è¡¨è·ç¦»å¾ˆè¿œï¼‰çš„listï¼Œç”¨äºè®°å½•å½“å‰é¡¶ç‚¹ï¼ˆç´¢å¼•ä¸é¡¶ç‚¹åºå·ä¸€è‡´æ˜¯1-26ï¼‰å¯¹äºé¡¶ç‚¹1çš„æœ€çŸ­è·ç¦»ã€‚

2ï¼‰åˆå§‹åŒ–ä¸€ä¸ªé•¿åº¦ä¸º27ï¼Œå…ƒç´ å…¨æ˜¯0çš„listï¼Œå…ƒç´ å€¼ç”¨äºè®°å½•å½“å‰é¡¶ç‚¹ï¼ˆç´¢å¼•ä¸é¡¶ç‚¹åºå·ä¸€è‡´æ˜¯1-26ï¼‰æ˜¯å¦å·²ç»æ‰¾åˆ°äº†è·ç¦»é¡¶ç‚¹1çš„æœ€çŸ­è·¯å¾„ï¼Œç¡®å®šäº†æœ€çŸ­è·¯å¾„å°±ç½®è¯¥é¡¶ç‚¹åºå·å¯¹åº”ç´¢å¼•å€¼çš„å…ƒç´ ä¸º1ã€‚åé¢å°†è¿™é‡Œå…ƒç´ å€¼æ˜¯1çš„é¡¶ç‚¹ç§°ä¸ºâ€œå·²ç»ç¡®å®šçš„é›†åˆâ€ã€‚æ¯æ¬¡æ›´æ–°å®Œå„é¡¶ç‚¹åˆ°é¡¶ç‚¹1çš„è·ç¦»åï¼Œæ‰¾åˆ°æœ€çŸ­çš„ä¸€ä¸ªï¼Œå°†è¯¥é¡¶ç‚¹ä½ç½®å…ƒç´ ç½®1ï¼Œè¯¥é¡¶ç‚¹å°±ä¸å†å‚ä¸åç»­çš„éå†ã€‚

3ï¼‰åˆå§‹åŒ–ä¸€ä¸ªé•¿åº¦ä¸º27ï¼Œå…ƒç´ å…¨æ˜¯1çš„listï¼Œç”¨äºè®°å½•å½“å‰é¡¶ç‚¹åˆ°é¡¶ç‚¹1çš„æœ€çŸ­è·¯å¾„çš„å‰é©±é¡¶ç‚¹ï¼Œç”¨äºæœ€åå›æº¯è·¯å¾„ã€‚

**è¿‡ç¨‹ï¼š**

é¦–å…ˆæ‰¾åˆ°å’Œé¡¶ç‚¹1ç›´è¿çš„é¡¶ç‚¹ï¼Œæ‰¾åˆ°è¿™äº›é¡¶ç‚¹ä¸­è·ç¦»é¡¶ç‚¹1æœ€çŸ­çš„ä¸€ä¸ªé¡¶ç‚¹ï¼Œå°†è¯¥é¡¶ç‚¹åŠ å…¥â€œå·²ç»ç¡®å®šçš„é›†åˆâ€œï¼Œéå†è¯¥é¡¶ç‚¹çš„é‚»æ¥é¡¶ç‚¹ï¼Œæ›´æ–°é¡¶ç‚¹1åˆ°å„ä¸ªé‚»æ¥é¡¶ç‚¹çš„æœ€çŸ­è·ç¦»ã€‚å†æ‰¾åˆ°ç°åœ¨ä¸é¡¶ç‚¹1è·ç¦»æœ€çŸ­çš„é¡¶ç‚¹ï¼ˆåœ¨â€å·²ç»ç¡®å®šçš„é›†åˆâ€œä¸­çš„é¡¶ç‚¹å°±ä¸å†éå†ï¼‰ï¼Œå†å»éå†è¯¥é¡¶ç‚¹çš„é‚»æ¥é¡¶ç‚¹ï¼Œæ›´æ–°é¡¶ç‚¹1åˆ°è¿™äº›é‚»æ¥é¡¶ç‚¹çš„æœ€çŸ­è·ç¦»ï¼Œä»ä¸­æ‰¾åˆ°è·ç¦»æœ€çŸ­çš„é¡¶ç‚¹åŠ å…¥â€œå·²ç»ç¡®å®šçš„é›†åˆâ€ï¼Œå†éå†è¯¥é¡¶ç‚¹çš„é‚»æ¥é¡¶ç‚¹ï¼Œæ›´æ–°è¿™äº›é¡¶ç‚¹ä¸é¡¶ç‚¹1çš„æœ€çŸ­è·ç¦»ï¼Œæ‰¾åˆ°ä¸é¡¶ç‚¹1è·ç¦»æœ€çŸ­çš„é¡¶ç‚¹â€¦â€¦ä»¥æ­¤å¾ªç¯ç›´è‡³æ‰€æœ‰é¡¶ç‚¹éƒ½åŠ å…¥â€œç¡®å®šçš„é›†åˆâ€ã€‚

æ ¸å¿ƒæ€æƒ³ï¼š

æ¯æ¬¡å¾ªç¯éƒ½æ‰¾åˆ°å½“å‰è·ç¦»é¡¶ç‚¹1æœ€è¿‘çš„ä¸€ä¸ªé¡¶ç‚¹ï¼Œåˆ¤æ–­è·¯å¾„ä¸­ç»è¿‡è¯¥é¡¶ç‚¹åå†åˆ°è¾¾ä¸å…¶é‚»æ¥çš„å…¶ä»–é¡¶ç‚¹çš„è·ç¦»ï¼Œæ˜¯å¦æ¯”ä¹‹å‰å­˜å‚¨çš„è¿™äº›é¡¶ç‚¹åˆ°é¡¶ç‚¹1çš„è·ç¦»æ›´çŸ­ï¼Œå¦‚æœæ›´çŸ­å°±æ›´æ–°å¯¹åº”é¡¶ç‚¹åˆ°é¡¶ç‚¹1çš„æœ€çŸ­è·ç¦»ï¼Œæ›´æ–°å®Œåå†æ‰¾åˆ°ä¸é¡¶ç‚¹1è·ç¦»æœ€çŸ­çš„é¡¶ç‚¹é‡å¤ä¸Šè¿°æ“ä½œã€‚

```py
graph=[]
for i in range(27):
    graph.append([]) #åœ¨ä¸€ä¸ªlistä¸­æ”¾27ä¸ªlistï¼Œç´¢å¼•0-26
for i in range(27):
    for j in range(27):
        graph[i].append(0xffff) #å…ˆå°†å›¾ä¸­å„ä¸ªé¡¶ç‚¹ä¹‹é—´çš„è·ç¦»åˆå§‹åŒ–ä¸ºä¸€ä¸ªæ¯”è¾ƒå¤§çš„æ•°
f=open('./Downloads/dij.txt','r').readlines()  #æŒ‰è¡Œè¯»å–ï¼Œæ¯è¡Œå†…å®¹æ˜¯listä¸­çš„ä¸€ä¸ªå…ƒç´ ï¼Œå…¨éƒ¨å†…å®¹ç»„æˆä¸€ä¸ªæ•´ä½“çš„list
#è¿™é‡Œéœ€è¦å…ˆæ‰‹åŠ¨å°†txtæ–‡ä»¶ä¸­çš„æœ€åä¸€è¡Œæ¢è¡Œå»æ‰å¦åˆ™ä¼šå¤šä¸€ä¸ª'\n'
#print(f)
li=[]
for x in f:
    li.append(x.strip().split(' ')) #strip()åˆ é™¤å­—ç¬¦ä¸²å‰åç©ºæ ¼ï¼Œè¿™é‡Œæ˜¯å»æ‰äº†æœ€åçš„æ¢è¡Œç¬¦'\n'ï¼Œç„¶åå†æŒ‰' 'åˆ†å‰²æ¯è¡Œçš„æ¯ä¸ªå…ƒç´ ï¼ŒåŸæœ¬åœ¨åŒä¸€å­listä¸­çš„ä¸€è¡Œå…ƒç´ ä¹Ÿå½¼æ­¤ç‹¬ç«‹å‡ºæ¥
#print(li)
for x in li:
    graph[int(x[0])][int(x[1])]=int(x[2])
    graph[int(x[1])][int(x[0])]=int(x[2])

def try_dijstra():
    min_d=[0xffff for i in range(27)]  #è®°å½•ç‚¹iåˆ°èµ·ç‚¹1çš„æœ€çŸ­è·ç¦»
    route=[1 for i in range(27)]  #è®°å½•å‰é©±é¡¶ç‚¹
    isSure=[0 for i in range(27)]  #è®°å½•å„ç‚¹åˆ°èµ·ç‚¹è·ç¦»æ˜¯å¦å·²ç»ç¡®å®š
    for i in range(2,27):
        min_d[i]=graph[i][1]  #åˆå§‹åŒ–ä¸€ä¸‹èƒ½ç›´è¿1çš„é¡¶ç‚¹å’Œ1çš„è·ç¦»
    min_d[1]=0
    isSure[1]=1

    for i in range(26):
        min=0xfffff
        temp=-1
        for j in range(2,27): # æ‰¾åˆ°å½“å‰ç¦»é¡¶ç‚¹1æœ€è¿‘çš„é¡¶ç‚¹åŠ å…¥å·²ç»ç¡®å®šçš„â€œé¡¶ç‚¹é˜µè¥â€
            if isSure[j]==0 and min>min_d[j]:
                min=min_d[j]
                temp=j
        isSure[temp]=1
        for j in range(2,27):# åˆ¤æ–­ä»é¡¶ç‚¹1å¼€å§‹ï¼Œåœ¨ç»è¿‡è¯¥é¡¶ç‚¹åï¼Œå†åˆ°è¾¾å…¶é‚»æ¥é¡¶ç‚¹çš„è·ç¦»ï¼Œæ˜¯å¦æ¯”å…¶é‚»æ¥é¡¶ç‚¹åŸæœ¬åˆ°é¡¶ç‚¹1çš„è·ç¦»æ›´è¿‘ï¼Œå¦‚æœæ›´è¿‘å°±æ›´æ–°æœ€çŸ­è·ç¦»
            if min_d[j]>min_d[temp]+graph[temp][j]:
                min_d[j]=min_d[temp]+graph[temp][j]
                route[j]=temp
    return (route,min_d)

route,min_d=try_dijstra()
print(min_d[26]) #æœ€çŸ­è·ç¦»
print(route) #å‰é©±é¡¶ç‚¹

passv=[]  #å­˜æ”¾é¡¶ç‚¹ä¹‹é—´çš„â€œå†…å®¹â€ï¼ˆå†…å®¹æœ€åè¦ç»„æˆflag
for i in range(27):
    passv.append([]) # è¿˜æ˜¯åœ¨ä¸€ä¸ªlistä¸­æ”¾27ä¸ªlist
for i in range(27):
    for j in range(27):
        passv[i].append(0)  #éœ€è¦å°†å†…éƒ¨listä¸­åˆå§‹åŒ–å‡º27ä¸ªâ€œä½ç½®â€å¦åˆ™ä¼šæŠ¥é”™ç´¢å¼•è¶Šç•Œ
for x in li:
    passv[int(x[0])][int(x[1])]=x[3]
    passv[int(x[1])][int(x[0])]=x[3]

y=26
l=[]
while y!=1:
    print(y) #è¾“å‡ºç»ˆç‚¹åˆ°èµ·ç‚¹çš„æœ€çŸ­è·¯å¾„ç»è¿‡çš„é¡¶ç‚¹
    l.append(passv[y][route[y]]) #yåˆ°å…¶å‰é©±é¡¶ç‚¹route[y]ä¹‹é—´çš„å†…å®¹
    y=route[y]
print()
l=l[::-1]
for i in range(len(l)):
    print(l[i],end='')

'''
339
[1, 1, 1, 2, 2, 2, 2, 3, 3, 3, 5, 5, 5, 4, 4, 4, 6, 6, 6, 25, 9, 11, 12, 6, 18, 22, 25]
26 25 22 12 5 2 
FLAG{WEIVKASJVLSJCHFSJVHJSDEV}
'''
```



#### [GKCTF 2021]Randomï¼ˆæ¢…æ£®ç®—æ³•ï¼‰

```py
import random
from hashlib import md5

def get_mask():
    file = open("random.txt","w")
    for i in range(104):
        file.write(str(random.getrandbits(32))+"\n")
        file.write(str(random.getrandbits(64))+"\n")
        file.write(str(random.getrandbits(96))+"\n")
    file.close()
get_mask()
flag = md5(str(random.getrandbits(32)).encode()).hexdigest()
print(flag)

```

é€šè¿‡é˜…è¯»ä»£ç ï¼Œæˆ‘ä»¬çŸ¥é“æ˜¯æ±‚ç”Ÿæˆ104ç»„éšæœºæ•°åçš„åœéšæœºæ•°

é€šè¿‡ç®—æ³•å‡ºçš„éšæœºæ•°æ˜¯ä¼ªéšæœºæ•°ï¼Œè¿™é‡Œç”¨åˆ°çš„éšæœºæ•°ç”Ÿæˆå‡½æ•°å¼random.getrandbits(k)

> random.getrandbits(k)
>
> è¿”å›å…·æœ‰ k ä¸ªéšæœºæ¯”ç‰¹ä½çš„éè´Ÿ Python æ•´æ•°ã€‚ æ­¤æ–¹æ³•éš MersenneTwister ç”Ÿæˆå™¨ä¸€èµ·æä¾›ï¼Œå…¶ä»–ä¸€äº›ç”Ÿæˆå™¨ä¹Ÿå¯èƒ½å°†å…¶ä½œä¸º API çš„å¯é€‰éƒ¨åˆ†æä¾›ã€‚ åœ¨å¯èƒ½çš„æƒ…å†µä¸‹ï¼Œgetrandbits() ä¼šå¯ç”¨ randrange() æ¥å¤„ç†ä»»æ„å¤§çš„åŒºé—´ã€‚åœ¨ 3.9 ç‰ˆæ›´æ”¹: æ­¤æ–¹æ³•ç°åœ¨æ¥å—é›¶ä½œä¸º k çš„å€¼ã€‚


æ‰€ä»¥è¿™é¢˜è€ƒçš„å…¶å®æ˜¯æ¢…æ£®ç®—æ³•ï¼ŒMersenne Twisteræ˜¯ä¸ºäº†è§£å†³è¿‡å»ä¼ªéšæœºç”Ÿæˆå™¨PRNGäº§ç”Ÿçš„ä¼ªéšæœºæ•°è´¨é‡ä¸é«˜è€Œç”Ÿæˆçš„ï¼ˆä¼ é€é—¨ï¼š[æ¢…æ£®æ—‹è½¬ç®—æ³•](https://liam.page/2018/01/12/Mersenne-twister/#:~:text=%E6%A2%85%E6%A3%AE%E6%97%8B%E8%BD%AC%E7%AE%97%E6%B3%95%EF%BC%88Mersenne%20Twister%20Algorithm%EF%BC%8C%E7%AE%80%E7%A7%B0%20MT%EF%BC%89%E6%98%AF%E4%B8%BA%E4%BA%86%E8%A7%A3%E5%86%B3%E8%BF%87%E5%8E%BB%E4%BC%AA%E9%9A%8F%E6%9C%BA%E6%95%B0%E5%8F%91%E7%94%9F%E5%99%A8%EF%BC%88Pseudo-Random%20Number%20Generator%EF%BC%8C%E7%AE%80%E7%A7%B0%20PRNG%EF%BC%89%E4%BA%A7%E7%94%9F%E7%9A%84%E4%BC%AA%E9%9A%8F%E6%9C%BA%E6%95%B0%E8%B4%A8%E9%87%8F%E4%B8%8D%E9%AB%98%E8%80%8C%E6%8F%90%E5%87%BA%E7%9A%84%E6%96%B0%E7%AE%97%E6%B3%95%E3%80%82.%20%E8%AF%A5%E7%AE%97%E6%B3%95%E7%94%B1%E6%9D%BE%E6%9C%AC%E7%9C%9E%EF%BC%88Makoto,%E6%98%AF%E4%B8%BA%E4%BA%86%E8%A7%A3%E5%86%B3%E8%BF%87%E5%8E%BB%20PRNG%20%E8%B4%A8%E9%87%8F%E4%BD%8E%E4%B8%8B%E7%9A%84%E9%97%AE%E9%A2%98%EF%BC%8C%E9%82%A3%E4%B9%88%E9%A6%96%E5%85%88%E6%88%91%E4%BB%AC%E5%B0%B1%E5%BF%85%E9%A1%BB%E8%A6%81%E6%9C%89%E4%B8%80%E4%B8%AA%E8%83%BD%E5%A4%9F%E5%BA%A6%E9%87%8F%20PRNG%20%E8%B4%A8%E9%87%8F%E7%9A%84%E6%96%B9%E6%B3%95%E3%80%82.%20%E5%90%A6%E5%88%99%EF%BC%8C%E3%80%8C%E5%85%AC%E8%AF%B4%E5%85%AC%E6%9C%89%E7%90%86%E5%A9%86%E8%AF%B4%E5%A9%86%E6%9C%89%E7%90%86%E3%80%8D%EF%BC%8C%E6%88%91%E4%BB%AC%E5%B0%B1%E6%97%A0%E6%B3%95%E5%AF%B9%20PRNG%20%E4%BD%9C%E5%87%BA%E7%BB%9F%E4%B8%80%E7%9A%84%E8%AF%84%E4%BB%B7%E4%BA%86%E3%80%82.)ï¼‰ã€‚æˆ‘ä»¬äº†è§£MT19937èƒ½åšç”Ÿæˆåœ¨1<=k<=623ä¸ªå‡åŒ€åˆ†å¸ƒçš„32ä½éšæœºæ•°ã€‚è€ŒçœŸå·§æˆ‘ä»¬å·²ç»æœ‰624(ï¼ˆ104+104*64/32+104\*96/32ï¼‰=624)ä¸ªç”Ÿæˆçš„éšæœºæ•°äº†ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæ ¹æ®å·²æœ‰çš„éšæœºæ•°ï¼Œæˆ‘ä»¬å®Œå…¨å¯ä»¥æ¨å‡ºä¸‹é¢ä¼šç”Ÿæˆçš„éšæœºæ•°

æˆ‘ä»¬éœ€è¦ç”¨åˆ°rendcrackåº“

å…ˆäº†è§£ä¸€ä¸‹rendcrack

> randcrack
> å·¥ä½œåŸç†
> è¯¥ç”Ÿæˆå™¨åŸºäºM e r s e n n e T w i s t e r MersenneTwisterMersenneTwisterï¼ˆæ¢…æ£®ç®—æ³•ï¼‰ï¼Œèƒ½å¤Ÿç”Ÿæˆå…·æœ‰ä¼˜å¼‚ç»Ÿè®¡ç‰¹æ€§çš„æ•°å­—ï¼ˆä¸çœŸæ­£çš„éšæœºæ•°æ— æ³•åŒºåˆ†ï¼‰ã€‚ä½†æ˜¯ï¼Œæ­¤ç”Ÿæˆå™¨çš„è®¾è®¡ç›®çš„ä¸æ˜¯åŠ å¯†å®‰å…¨çš„ã€‚æ‚¨ä¸åº”åœ¨å…³é”®åº”ç”¨ç¨‹åºä¸­ç”¨ä½œåŠ å¯†æ–¹æ¡ˆçš„PRNGã€‚
> æ‚¨å¯ä»¥[åœ¨ç»´åŸºç™¾ç§‘ä¸Š]äº†è§£æœ‰å…³æ­¤ç”Ÿæˆå™¨çš„æ›´å¤šä¿¡æ¯(https://en.wikipedia.org/wiki/Mersenne_Twister).
> è¿™ä¸ªé¥¼å¹²çš„å·¥ä½œåŸç†å¦‚ä¸‹ã€‚
> å®ƒä»ç”Ÿæˆå™¨è·å¾—å‰624ä¸ª32ä½æ•°å­—ï¼Œå¹¶è·å¾—Mersenne TwisterçŸ©é˜µçš„æœ€å¯èƒ½çŠ¶æ€ï¼Œå³å†…éƒ¨çŠ¶æ€ã€‚ä»è¿™ä¸€ç‚¹æ¥çœ‹ï¼Œå‘ç”µæœºåº”è¯¥ä¸è£‚è§£å™¨åŒæ­¥ã€‚
> å¦‚ä½•ä½¿ç”¨
> å°†ç”Ÿæˆå™¨ç”Ÿæˆçš„32ä½æ•´æ•°å‡†ç¡®åœ°è¾“å…¥crackeréå¸¸é‡è¦ï¼Œå› ä¸ºå®ƒä»¬æ— è®ºå¦‚ä½•éƒ½ä¼šç”Ÿæˆï¼Œä½†å¦‚æœæ‚¨ä¸è¯·æ±‚å®ƒä»¬ï¼Œåˆ™ä¼šåˆ é™¤å®ƒä»¬ã€‚ åŒæ ·ï¼Œæ‚¨å¿…é¡»åœ¨å‡ºç°æ–°ç§å­ä¹‹åï¼Œæˆ–è€…åœ¨ç”Ÿæˆ624 âˆ— 32 ä½ä¹‹åï¼Œå‡†ç¡®åœ°ä¸ºç ´è§£ç¨‹åºé¦ˆç”µï¼Œå› ä¸ºæ¯ä¸ª624 âˆ— 32 ä½æ•°å­—ç”Ÿæˆå™¨éƒ½ä¼šæ”¹å˜å…¶çŠ¶æ€ï¼Œå¹¶ä¸”ç ´è§£ç¨‹åºè®¾è®¡ä¸ºä»æŸä¸ªçŠ¶æ€å¼€å§‹é¦ˆç”µã€‚

```py
from hashlib import md5
from randcrack import RandCrack
def foo(l,i):
    a=[]
    a.append(l[i])
    b1=l[i+1]>>32
    b2=l[i+1]&(2**32-1)
    a.append(b2)
    a.append(b1)
    b1=l[i+2]>>64
    b2=(l[i+2]&(2**64-1))>>32
    b3=l[i+2]&(2**32-1)
    a.append(b3)
    a.append(b2)
    a.append(b1)
    return a
with open(r'random.txt','r') as f:
    l=f.readlines()
l=[int(i.strip()) for i in l]
ll=[]
for i in range(0,len(l),3):
    ll+=foo(l,i)
rc=RandCrack()
for i in ll:
    rc.submit(i)
aa=rc.predict_getrandbits(32)
print(md5(str(aa).encode()).hexdigest())

```

è„šæœ¬æºäºï¼š

ä»£ç å°±å¾ˆå®¹æ˜“è¯»æ‡‚äº†ï¼Œå…ˆå°†æˆ‘ä»¬æœ‰çš„éšæœºæ•°æ’åˆ—åˆ°ä¸€ä¸ªåˆ—è¡¨llä¸­ï¼Œç„¶åæŒ¨ä¸ªç”¨RandCrack.submit()æäº¤ï¼Œæœ€åç”¨RandCrack.predict_getrandbits()é¢„æµ‹ä¸‹ä¸€ä¸ª32ä½éšæœºæ•°ï¼Œç„¶åmd5ä¸€ä¸‹è¾“å‡ºå°±å¥½äº†



#### [SUCTF2019]MTï¼ˆæ¢…æ£®ç®—æ³•ï¼‰

è€ƒç‚¹æ˜¯MT19937,ä¹Ÿå°±æ˜¯æ¢…æ£®æ—‹è½¬ç®—æ³•

```py
from Crypto.Random import random
from Crypto.Util import number
from flag import flag

def convert(m):
    m = m ^ m >> 13
    m = m ^ m << 9 & 2029229568
    m = m ^ m << 17 & 2245263360
    m = m ^ m >> 19
    return m

def transform(message):
    assert len(message) % 4 == 0
    new_message = ''
    for i in range(len(message) / 4):
        block = message[i * 4 : i * 4 +4]
        block = number.bytes_to_long(block)
        block = convert(block)
        block = number.long_to_bytes(block, 4)
        new_message += block
    return new_message

transformed_flag = transform(flag[5:-1].decode('hex')).encode('hex')
print 'transformed_flag:', transformed_flag
# transformed_flag: 641460a9e3953b1aaa21f3a2

```

åŠ å¯†åŸç†å¾ˆç®€å•ï¼Œå°±æ˜¯é€šè¿‡ **convert()** å‡½æ•°è·å–éšæœºæ•°å°† flag åŠ å¯†ã€‚è€ƒçš„é¢˜å‹æ˜¯ **é€†å‘ extract_numberå‡½æ•°**

è§£é¢˜EXPï¼š

```py
#python2
from Crypto.Util import number

# right shift inverse
def inverse_right(res, shift, bits=32):
    tmp = res
    for i in range(bits // shift):
        tmp = res ^ tmp >> shift
    return tmp


# right shift with mask inverse
def inverse_right_mask(res, shift, mask, bits=32):
    tmp = res
    for i in range(bits // shift):
        tmp = res ^ tmp >> shift & mask
    return tmp

# left shift inverse
def inverse_left(res, shift, bits=32):
    tmp = res
    for i in range(bits // shift):
        tmp = res ^ tmp << shift
    return tmp


# left shift with mask inverse
def inverse_left_mask(res, shift, mask, bits=32):
    tmp = res
    for i in range(bits // shift):
        tmp = res ^ tmp << shift & mask
    return tmp


def extract_number(y):
    y = y ^ y >> 11
    y = y ^ y << 7 & 2636928640
    y = y ^ y << 15 & 4022730752
    y = y ^ y >> 18
    return y&0xffffffff

def convert(y):
    y = inverse_right(y,19)
    y = inverse_left_mask(y,17,2245263360)
    y = inverse_left_mask(y,9,2029229568)
    y = inverse_right(y,13)
    return y&0xffffffff

def transform(message):
    assert len(message) % 4 == 0
    new_message = ''
    for i in range(len(message) / 4):
        block = message[i * 4 : i * 4 +4]
        block = number.bytes_to_long(block)
        block = convert(block)
        block = number.long_to_bytes(block, 4)
        new_message += block
    return new_message

transformed_flag = '641460a9e3953b1aaa21f3a2'
c = transformed_flag.decode('hex')
flag = transform(c)
print flag.encode('hex')

```

ç¬¬äºŒç§è§£æ³•æ˜¯åŸºäºå‡ºé¢˜äººçš„ç®—æ³•ï¼Œä½¿å¾—æ˜æ–‡é€šè¿‡ä¸æ–­çš„åŠ å¯†æœ€åè¿˜æ˜¯æ˜æ–‡ã€‚

```py
#python2
from Crypto.Random import random
from Crypto.Util import number

def convert(m):
    m = m ^ m >> 13
    m = m ^ m << 9 & 2029229568
    m = m ^ m << 17 & 2245263360
    m = m ^ m >> 19
    return m

def transform(message):
    assert len(message) % 4 == 0
    new_message = ''
    for i in range(len(message) / 4):
        block = message[i * 4 : i * 4 +4]
        block = number.bytes_to_long(block)
        block = convert(block)
        block = number.long_to_bytes(block, 4)
        new_message += block
    return new_message
def circle(m):
    t=m
    while True:
        x=t
        t=transform(t)
        if t==m:
            return x
transformed_flag='641460a9e3953b1aaa21f3a2'
flag = circle(transformed_flag.decode('hex')).encode('hex')
print('transformed_flag:', flag)

```



### ä¸¢å¤±çš„md5(æš´åŠ›æ±‚è§£)

å°†ä»£ç ä¿®æ”¹

```
import hashlib

# è¿­ä»£æŒ‡å®šèŒƒå›´å†…çš„ASCIIå­—ç¬¦
for i in range(32, 127):
    for j in range(32, 127):
        for k in range(32, 127):
            # åˆ›å»ºè¦è¿›è¡Œå“ˆå¸Œè¿ç®—çš„å­—ç¬¦ä¸²
            test_string = 'TASC' + chr(i) + 'O3RJMV' + chr(j) + 'WDJKX' + chr(k) + 'ZM'
            m = hashlib.md5()
            # å°†å­—ç¬¦ä¸²ç¼–ç ä¸ºå­—èŠ‚å¹¶æ›´æ–°å“ˆå¸Œå¯¹è±¡
            hashlib æ¨¡å—ä¸­çš„ update æ–¹æ³•ç”¨äºå°†æ•°æ®ä¼ é€’ç»™å“ˆå¸Œå¯¹è±¡ï¼Œä»¥ä¾¿ç”Ÿæˆå“ˆå¸Œå€¼ã€‚åœ¨ä½¿ç”¨ update æ–¹æ³•æ—¶ï¼Œéœ€è¦ä¼ å…¥ä¸€ä¸ªå­—             èŠ‚ç±»å‹çš„æ•°æ®ã€‚
            m.update(test_string.encode('utf-8'))
            des = m.hexdigest()
            # æ£€æŸ¥å“ˆå¸Œå€¼æ˜¯å¦åŒ…å«æŒ‡å®šçš„å­å­—ç¬¦ä¸²
            if 'e9032' in des and 'da' in des and '911513' in des:
                print(des)

//e9032994dabac08080091151380478a2
```

å¾—åˆ°flag

### Alice and Bobï¼ˆè´¨å› æ•°åˆ†ç¦»ï¼‰

https://zh.numberempire.com/numberfactorizer.php

```
import hashlib
def prime_factors(n):
    """
    åˆ†è§£ç»™å®šæ•´æ•°nçš„è´¨å› æ•°ã€‚
    è¿”å›ä¸€ä¸ªåˆ—è¡¨ï¼Œå…¶ä¸­åŒ…å«nçš„æ‰€æœ‰è´¨å› æ•°ã€‚
    """
    # åˆå§‹åŒ–ä¸€ä¸ªç©ºåˆ—è¡¨æ¥å­˜å‚¨è´¨å› æ•°
    factors = []

    # ä»2å¼€å§‹ï¼Œé€ä¸ªæ£€æŸ¥æ¯ä¸ªæ•°æ˜¯å¦æ˜¯nçš„å› æ•°
    for i in range(2, int(n ** 0.5) + 1):
        # å¦‚æœiæ˜¯nçš„å› æ•°ï¼Œå°†å…¶æ·»åŠ åˆ°è´¨å› æ•°åˆ—è¡¨ä¸­
        if n % i == 0:
            factors.append(i)
            # å¦‚æœiä¸æ˜¯è´¨æ•°ï¼Œåˆ™n/iä¹Ÿæ˜¯ä¸€ä¸ªå› æ•°ï¼Œå°†å…¶ä¹Ÿæ·»åŠ åˆ°è´¨å› æ•°åˆ—è¡¨ä¸­
            if i != n // i:
                factors.append(n // i)

                # å¦‚æœnæ˜¯å¶æ•°ä¸”å¤§äº2ï¼Œåˆ™å®ƒæœ¬èº«ä¸æ˜¯è´¨æ•°ï¼Œéœ€è¦ç‰¹åˆ«å¤„ç†
    if n > 2 and n % 2 == 0:
        factors.append(2)

    return factors
# æµ‹è¯•å‡½æ•°
print(prime_factors(98554799767))  # è¾“å‡º: [101999, 966233]

a=hashlib.md5()
a.update("101999966233".encode('utf-8'))
print(a.hexdigest().lower())

//d450209323a847c8d01c6be47c81811a
```

### å¤§å¸çš„å¯†ç æ­¦å™¨ï¼ˆå‡¯æ’’å¯†ç ï¼‰

https://www.lddgo.net/encrypt/caesar-cipher

![image-20240602144536344](https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202406021445451.png)

ä¸‹è½½ä¸‹æ¥çš„æ–‡ä»¶é•¿è¿™æ ·ï¼Œæˆ‘ä»¬ç»™å®ƒåŠ ä¸Š.zipåç¼€å°±èƒ½æ‰“å¼€æ–‡ä»¶äº†

![image-20240602144656911](https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202406021446943.png)

ä»å·²çŸ¥ä¿¡æ¯å¯çŸ¥ä¸ºå‡¯æ’’å¯†ç ï¼Œæˆ‘ä»¬ç”¨å·¥å…·è¿›è¡Œç§»ä½

![image-20240602144735700](https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202406021447735.png)

ç¬¬13ä½å‡ºç°å•è¯ï¼Œæˆ‘ä»¬æŠŠé™„ä»¶çš„å­—ç¬¦ä¸²ä¹Ÿç§»ä½

![image-20240602144809987](https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202406021448012.png)

å¾—åˆ°flag{PbzrPuvan}

### Windowsç³»ç»Ÿå¯†ç ï¼ˆmd5è§£å¯†ï¼‰

https://www.cmd5.com/

å°†ä¸‹è½½çš„é™„ä»¶è§£å‹åï¼Œå‘ç°æ–‡ä»¶çš„åç¼€ä¸ºhashï¼Œå³åŸæ–‡æœ¬ä½¿ç”¨äº†å“ˆå¸ŒåŠ å¯†ï¼Œä¼—æ‰€å‘¨çŸ¥ï¼Œå“ˆå¸Œå¯†ç çš„åŠ å¯†çš„è¿‡ç¨‹è¢«è®¤ä¸ºæ˜¯ä¸å¯é€†çš„ï¼Œ

ä¹Ÿå°±æ˜¯è¯´ï¼Œäººä»¬è®¤ä¸ºä»å“ˆå¸Œä¸²ä¸­æ˜¯ä¸å¯èƒ½è¿˜åŸå‡ºåŸå£ä»¤çš„ã€‚è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨è®°äº‹æœ¬æ‰“å¼€æ–‡ä»¶ï¼Œå¾—åˆ°ä»¥ä¸‹å†…å®¹ï¼š

![image-20240602150144576](https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202406021501603.png)

è§£é¢˜æ€è·¯

ç”±äºå“ˆå¸Œå¯†ç çš„ä¸å¯é€†æ€§ï¼Œæˆ‘ä»¬åªèƒ½å€Ÿç”¨ä¸€äº›å·¥å…·æ¥è¿›è¡Œæ“ä½œï¼Œè¿™é‡Œæˆ‘ä½¿ç”¨çš„å·¥å…·ç½‘å€æ˜¯ï¼š[MD5è§£å¯†](https://www.cmd5.com/)ã€‚åˆ†åˆ«å¯¹ç¬¬äºŒè¡Œçš„ä¸‰æ®µæ–‡å­—è¿›è¡Œ

æ±‚è§£ï¼Œä¾¿å¯å¾—åˆ°ç­”æ¡ˆä¸ºï¼šgood-luck

### ä¿¡æ¯åŒ–æ—¶ä»£çš„æ­¥ä¼ï¼ˆä¸­æ–‡ç”µç ï¼‰

![image-20240602150614823](https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202406021506854.png)

è¿™æ˜¯ä¸€ä¸²ä¸­æ–‡ä»£ç ï¼ˆåˆ«é—®æˆ‘ä¸ºä»€ä¹ˆçŸ¥é“ï¼‰

æ‰¾ä¸ªç½‘ç«™è§£å¯†

https://dianma.bmcx.com/

![image-20240602150712490](https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202406021507539.png)

flagå‡ºæ¥äº†

### å‡¯æ’’ï¼Ÿæ›¿æ¢ï¼Ÿå‘µå‘µ!ï¼ˆå‡¯æ’’å¯†ç çˆ†ç ´ï¼‰

å‡¯æ’’å¯†ç ä¸€èˆ¬å°±æ˜¯26ä¸ªå­—æ¯ç»è¿‡å•çº¯çš„æŒ‰å­—æ¯é¡ºåºæ¥ä½ç§»çš„[åŠ å¯†](https://so.csdn.net/so/search?q=åŠ å¯†&spm=1001.2101.3001.7020)æ–¹æ³•ï¼ˆä¸€èˆ¬ï¼‰

å¦‚ï¼šabc=def

è¿›é˜¶ç‰ˆçš„å‡¯æ’’å°±ä¸æŒ‰ç…§å­—æ¯é¡ºåºçš„åŠ å¯†

å¦‚ï¼šabc=dhj

æ‰€ä»¥å°±è¦ç»è¿‡æš´åŠ›ç ´è§£å‡ºæ¯ä¸€ç§å¯èƒ½çš„å¯¹åº”åŠ å¯†

![image-20240602151935377](https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202406021519410.png)

å‰é¢çš„MTHJå’Œå­—ç¬¦ä¸²ä¸­é—´çš„{}æ˜¯æ˜æ˜¾çš„flag{}çš„æ ¼å¼ï¼Œæ‰€ä»¥å°±æ¨æ–­è¿™é‡Œçš„

MTHJå¯¹åº”çš„æ˜æ–‡å°±æ˜¯flag

ç„¶åå°±å¯¹å­—ç¬¦ä¸²ä¸­çš„å…¶ä»–20ä¸ªå­—æ¯è¿›è¡Œçˆ†ç ´å¯¹æ¯”ï¼Œå¯ä»¥å†™è„šæœ¬ï¼ˆä¸ä¼šå“ˆå“ˆå“ˆï¼‰

ç”¨å·¥å…·å§

[quipqiup](https://quipqiup.com/)

![image-20240602151946218](https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202406021519431.png)

flagè¦å»ç©ºæ ¼ï¼Œåœ¨ä¸¤è¾¹åŠ {}

### èŒèŒå“’çš„å…«æˆ’ï¼ˆçŒªåœˆå¯†ç ï¼‰

æ‰“å¼€å›¾ç‰‡ï¼Œåœ¨ä¸‹é¢å‘ç°ä¸€äº›å›¾æ¡ˆ

![image-20240602152506490](https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202406021525612.png)

ç»è¿‡æŸ¥è¯¢ï¼Œä¸ºçŒªåœˆå¯†ç 

![img](https://img-blog.csdnimg.cn/direct/593bc400d2a443dfba463301484e8dfd.png)

å¯¹ç…§å¯†ç è¡¨ä¾æ¬¡ä»£å…¥å³å¯ï¼Œå¾—åˆ°ç­”æ¡ˆä¸ºï¼šflag{whenthepigwanttoeat}

### æƒé™è·å¾—ç¬¬ä¸€æ­¥(md5è§£å¯†)

![image-20240602152801553](https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202406021528603.png)

æ‹¿å»md5è§£å¯†å°±èƒ½å¾—åˆ°flagäº†

### ä¼ ç»ŸçŸ¥è¯†+å¤å…¸å¯†ç 

å°æ˜æŸä¸€å¤©æ”¶åˆ°ä¸€å°å¯†ä¿¡ï¼Œä¿¡ä¸­å†™äº†å‡ ä¸ªä¸åŒçš„å¹´ä»½
è¾›å¯ï¼Œç™¸å·³ï¼Œä¸™æˆŒï¼Œè¾›æœªï¼Œåºšè¾°ï¼Œç™¸é…‰ï¼Œå·±å¯ï¼Œç™¸å·³ã€‚
ä¿¡çš„èƒŒé¢è¿˜å†™æœ‰â€œ+ç”²å­â€ï¼Œè¯·è§£å‡ºè¿™æ®µå¯†æ–‡ã€‚

keyå€¼ï¼šCTF{XXX}

![img](https://img-blog.csdnimg.cn/direct/a7d8b2c8225442e38d6647c772e921e2.png)

æŸ¥è¡¨å¯å¾—åºå·ï¼š28ï¼Œ30ï¼Œ23ï¼Œ8ï¼Œ17ï¼Œ10ï¼Œ16ï¼Œ30

ä¸”ä¸€ç”²å­ä¸º60ï¼Œæ‰€ä»¥æ¯ä¸ªåŠ ä¸Š60

88ï¼Œ90ï¼Œ83ï¼Œ68ï¼Œ77ï¼Œ70ï¼Œ76ï¼Œ90

å¯¹åº”asciiå­—ç¬¦ä¸º

XZSDMFLZ

```
a=[88,90,83,68,77,70,76,90]
b=''
for i in a:
    b+=chr(i)
print(b)
```

ç”±äºå¤å…¸å¯†ç åªæœ‰æ …æ å¯†ç å’Œå‡¯æ’’å¯†ç 

æˆ‘ä»¬å…ˆè¿›è¡Œå‡¯æ’’å¯†ç ï¼Œç§»åŠ¨5ä½è¿›è¡Œè§£å¯†å¾—åˆ°SUNYHAGU

![image-20240602155404900](https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202406021554935.png)

å†å°†SUNYHAGUè¿›è¡Œæ …æ å¯†ç è§£å¯†

![image-20240602155448691](https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202406021554791.png)

å¾—åˆ°flag{SHUANGYU}

### ä¸–ä¸Šæ— éš¾äº‹(æš´åŠ›ç ´è§£)

![image-20240602171546125](https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202406021715173.png)

æ‰“å¼€é¡µé¢å‘ç°ä¸€å¤§å †å­—æ¯ï¼Œæˆ‘ä»¬ç›´æ¥æš´åŠ›ç ´è§£

![image-20240602171617317](https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202406021716473.png)

flagè®°å¾—æŠŠå­—æ¯æ”¹ä¸ºå°å†™

### [AFCTF2018]Morseï¼ˆæ‘©æ–¯å¯†ç &16è¿›åˆ¶è§£ç ï¼‰

![image-20240603215538129](https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202406032155281.png)

å‹ç¼©åŒ…é‡Œä¸€çœ‹å°±æ˜¯æ‘©æ–¯å¯†ç ï¼Œä½†è¦æŠŠ/æ”¹ä¸ºç©ºæ ¼

![image-20240603215630058](https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202406032156144.png)

è§£ç åè¿˜éœ€16è¿›åˆ¶è§£ç æ‰èƒ½å¾—åˆ°flag

![image-20240603215659800](https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202406032157003.png)

### è¿˜åŸå¤§å¸ˆ(md5çˆ†ç ´).

```
import hashlib

mystery_md5 = "E903???4DAB????08?????51?80??8A?"
for i in range(65, 91):
    for j in range(65, 91):
        for k in range(65, 91):
            # print(f"TASC{chr(i)}O3RJMV{chr(j)}WDJKX{chr(k)}ZMd", end=";")
            # è®¡ç®—å€™é€‰å­—ç¬¦ä¸²çš„MD5å“ˆå¸Œå€¼
            plaintext = f"TASC{chr(i)}O3RJMV{chr(j)}WDJKX{chr(k)}ZM"
            md5_hash = hashlib.md5(plaintext.encode('utf8')).hexdigest().upper()  # æ³¨æ„å¤§å°å†™
            # print(md5_hash[:4])
            # æ¯”è¾ƒMD5ç çš„éƒ¨åˆ†
            if md5_hash[:4] == mystery_md5[:4]:
                print(plaintext)
                print(md5_hash)
```

### å¼‚æ€§ç›¸å¸(äºŒè¿›åˆ¶å¼‚æˆ–)

æèµ·å¼‚æ€§æˆ‘ä»¬å¯ä»¥æƒ³åˆ°01ï¼Œä¹Ÿå°±æ˜¯äºŒè¿›åˆ¶ï¼Œæˆ‘ä»¬ç”¨010æŠŠæ–‡ä»¶å†…å®¹è½¬åŒ–æˆäºŒè¿›åˆ¶å†å¼‚æˆ–

```
a = '0110000101110011011000010110010001110011011000010111001101100100011000010111001101100100011000010111001101100100011000010111001101100100011000010111001101100100011000010111001101100100011000010111001101100100011000010111001101100100011000010111001101100100011100010111011101100101011100110111000101100110'
b = '0000011100011111000000000000001100001000000001000001001001010101000000110001000001010100010110000100101101011100010110000100101001010110010100110100010001010010000000110100010000000010010110000100011000000110010101000100011100000101010101100100011101010111010001000001001001011101010010100001010000011011'
c = ''

for i in range(len(a)):
    if a[i] == b[i]:
        c += '0'
    else:
        c += '1'
print(c)
```

å¾—åˆ°

```
0110011001101100011000010110011101111011011001010110000100110001011000100110001100110000001110010011100000111000001110010011100100110010001100100011011100110110011000100011011101100110001110010011010101100010001101010011010001100001001101110011010000110011001101010110010100111000001110010110010101111101
```

æˆ‘ä»¬å†è§£ç å¾—åˆ°flag

```
flag{ea1bc0988992276b7f95b54a7435e89e}
```



### [GXYCTF2019]CheckInï¼ˆROT-NåŠ å¯†ï¼‰

![image-20240611170339389](https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202406111703465.png)

å‡ºç°äº†ä¸¤ä¸ªç­‰å·ï¼Œæˆ‘ä»¬å…ˆbase64è§£å¯†

![image-20240611170402562](https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202406111704759.png)

é‡Œé¢æ²¡æœ‰{}å¯ä»¥çŸ¥é“ä¸æ˜¯å‡¯æ’’åŠ å¯†ï¼Œæ²¡æœ‰=ä¸æ˜¯base64

ä½†å¯ä»¥å‘ç°è¿™é‡Œçš„æ¯ä¸€ä¸ªå­—ç¬¦çš„ASCIIåœ¨33-126

å¯ä»¥å‘ç°æ˜¯ROT-NåŠ å¯†

[ROT-Nåœ¨çº¿åŠ å¯†](https://www.qqxiuzi.cn/bianma/ROT5-13-18-47.php)

å¾—åˆ°flag

![image-20240611170522341](https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202406111705390.png)



### Cipherï¼ˆplayfairè§£å¯†ï¼‰

é¢˜ç›®æç¤ºï¼šå…¬å¹³çš„ç©å§ï¼Œä¹Ÿå°±æ˜¯playfairï¼Œæ­£å¥½æœ‰è¿™ä¸€ç§åŠ å¯†ä¸ºæ™®è±è²å°”å¯†ç ï¼Œä»¥playfairä¸ºå¯†é’¥è¿›è¡Œæ™®è±è²å°”å¯†ç è§£å¯†ï¼ˆè¦ä¸æ˜¯æˆ‘çœ‹äº†wpï¼Œé¬¼çŸ¥é“è¿™ç©æ„ï¼‰

[playfairè§£å¯†](https://www.metools.info/code/playfair_186.html)

![image-20240611171809161](https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202406111718297.png)

ç”¨flag{}åŒ…è£¹ä½ï¼Œå¾—åˆ°flag{itisnotaproblemhavefun}



### [BJDCTF2020]è¿™æ˜¯base??ï¼ˆå­—ç¬¦æ›¿æ¢ï¼‰

è¿™é¢˜çš„é¢˜ç›®æ˜¯baseï¼Œæˆ‘ä»¬å¯ä»¥æƒ³åˆ°base64ï¼Œä½†txtæ–‡æ¡£ç»™å‡ºäº†2ä¸ªæ•°æ®ï¼Œä¸éš¾æƒ³åˆ°å­—ç¬¦æ›¿ä»£

![image-20240616212448415](https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202406162124459.png)

æˆ‘ä»¬å°†chipertextçš„å­—ç¬¦ä¸dictçš„å­—ç¬¦ä¸€ä¸€å¯¹åº”ï¼Œå¾—åˆ°æ¯ä¸€ä¸ªå­—ç¬¦åœ¨dictä¸­çš„ä¸‹æ ‡

æˆ‘ä»¬æŸ¥æ‰¾base64çš„æ ‡å‡†å­—å…¸

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img-blog.csdnimg.cn/20200319220730248.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NDAxNzgzOA==,size_16,color_FFFFFF,t_70)

å°†æ¯ä¸€ä¸ªå­—ç¬¦åœ¨dictä¸­çš„ä¸‹æ ‡ä¸æ ‡å‡†å­—å…¸çš„å­—ç¬¦ç›¸å¯¹åº”

å†™è„šæœ¬

```
import base64

a={0: 'J', 1: 'K', 2: 'L', 3: 'M', 4: 'N', 5: 'O', 6: 'x', 7: 'y', 8: 'U', 9: 'V', 10: 'z', 11: 'A', 12: 'B', 13: 'C', 14: 'D', 15: 'E', 16: 'F', 17: 'G', 18: 'H', 19: '7', 20: '8', 21: '9', 22: 'P', 23: 'Q', 24: 'I', 25: 'a', 26: 'b', 27: 'c', 28: 'd', 29: 'e', 30: 'f', 31: 'g', 32: 'h', 33: 'i', 34: 'j', 35: 'k', 36: 'l', 37: 'm', 38: 'W', 39: 'X', 40: 'Y', 41: 'Z', 42: '0', 43: '1', 44: '2', 45: '3', 46: '4', 47: '5', 48: '6', 49: 'R', 50: 'S', 51: 'T', 52: 'n', 53: 'o', 54: 'p', 55: 'q', 56: 'r', 57: 's', 58: 't', 59: 'u', 60: 'v', 61: 'w', 62: '+', 63: '/', 64: '='}
b="FlZNfnF6Qol6e9w17WwQQoGYBQCgIkGTa9w3IQKw"
base64_list = ['A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', 'I', 'J', 'K', 'L', 'M', 'N', 'O', 'P','Q', 'R', 'S', 'T', 'U', 'V', 'W', 'X', 'Y', 'Z', 'a', 'b', 'c', 'd', 'e', 'f','g', 'h', 'i', 'j', 'k', 'l', 'm', 'n', 'o', 'p', 'q', 'r', 's', 't', 'u', 'v','w', 'x', 'y', 'z', '0', '1', '2', '3', '4', '5', '6', '7', '8', '9', '+', '/']
flag=''

for i in b:
    for j in a:
        if i == a[j]:
            flag+=base64_list[j]

print(base64.b64decode(flag))

//b'BJD{D0_Y0u_kNoW_Th1s_b4se_map}'
```



### robomunicationï¼ˆéŸ³é¢‘æ‘©æ–¯å¯†ç ï¼‰

ä¸‹è½½æ–‡ä»¶åï¼Œå‘ç°æ˜¯ä¸ªéŸ³é¢‘ï¼Œç”¨[Audacity](https://www.audacityteam.org/)æ‰“å¼€ï¼Œå‘ç°å®ƒåœ¨å“”å“”å“”å“”  å“” å“”æ³¢å“”å“”ã€‚ã€‚ã€‚åŸæ¥æ˜¯æ‘©æ–¯å¯†ç 

æ•´ç†åå¾—åˆ°ï¼š.... . .-.. .-.. --- .-- .... .- - .. ... - .... . -.- . -.-- .. - .. ... -... --- --- .--. -... . . .--.

è§£ç å¾—

å¯†ç æ˜¯ï¼šHELLOWHATISTHEKEYITISBOOPBEEP

æœ€ç»ˆè§£å¾—flagä¸ºBOOPBEEP





### [WUSTCTF2020]ä½›è¯´ï¼šåªèƒ½å››å¤©ï¼ˆè§£å¯†å¤§ç¤¼åŒ…ï¼‰

![image-20240818202237098](https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202408182022154.png)

ä½›æ›°åŠ å¯†ç½‘ç«™è§£å¯†â€”â€”http://hi.pcmoe.net/buddha.htmlï¼Œå¾—åˆ°

![image-20240818202346306](https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202408182023444.png)

é©¬ä¸Šå»æ ¸å¿ƒä»·å€¼è§‚è§£å¯†â€”â€”http://www.hiencode.com/cvencode.htmlå¾—åˆ°

![image-20240818202511160](https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202408182025210.png)

è§£å¯†å†…å®¹æç¤ºæ …æ å¯†ç ï¼Œæˆ‘ä»¬ç”¨æ …æ å¯†ç è§£å¯†

è¦å»æ‰åé¢çš„__doyouknowfence

[æ …æ å¯†ç _æ …æ å¯†ç åœ¨çº¿åŠ å¯†è§£å¯†ã€Wå‹ã€‘-ME2åœ¨çº¿å·¥å…· (metools.info)](http://www.metools.info/code/fence154.html)

![image-20240818204034605](https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202408182040649.png)

æˆ‘ä»¬ç”¨[å‡¯æ’’å¯†ç è§£å¯†](https://ctf.bugku.com/tool/caesar)

![image-20240818204511820](https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202408182045961.png)

æˆ‘ä»¬è§‚å¯Ÿæšä¸¾åçš„ç»“æœéƒ½æ²¡æœ‰å°å†™å­—æ¯ï¼Œæˆ‘ä»¬è€ƒè™‘base32

åœ¨åç§»ä¸º3æ˜¯å¾—åˆ°flag

![img](https://img2022.cnblogs.com/blog/2656364/202207/2656364-20220703183310796-1688771401.png)



### è¾¾èŠ¬å¥‡å¯†ç ï¼ˆè„‘æ´é¢˜ï¼‰

![image-20240818205419252](https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202408182054283.png)

æˆ‘ä»¬è§‚å¯Ÿæ•°å­—åˆ—å‘ç°è·Ÿæ–æ³¢é‚£å¥‘æ•°åˆ—çš„æ•°å­—ä¸€æ ·ä½†æ˜¯ä½ç½®ä¸ä¸€æ ·

æˆ‘ä»¬å¯¹æ¯”æ¥çœ‹çœ‹

```
def fib_loop_for(n):
    a, b = 0, 1
    for _ in range(n):
        a, b = b, a + b
    return a
for i in range(1,33):
    print(fib_loop_for(i))

```

```
1 1 2 3 5 8 13 21 34 55 89 144 233 377 610 987 1597 2584 4181 6765 10946 17711 28657 46368 75025 121393 196418 317811 514229 832040 1346269 2178309

1 233 3 2584 1346269 144 5 196418 21 1597 610 377 10946 89 514229 987 8 55 6765 2178309 121393 317811 46368 4181 1 832040 2 28657 75025 34 13 17711  

c="36968853882116725547342176952286"

```

æˆ‘ä»¬å‘ç°æ•°å­—åˆ—å’Œç¥ç§˜æ•°å­—ä¸²çš„ä¸ªæ•°ä¸€æ ·ï¼Œæ‰€ä»¥æˆ‘ä»¬çŒœæµ‹è¦é€šè¿‡æ¯”å¯¹æ–æ³¢é‚£å¥‘æ•°åˆ—ï¼Œæ¥å°†cè¿›è¡Œæ’åº

ä¾‹å¦‚ï¼š1åœ¨æ–æ³¢é‚£å¥‘æ•°åˆ—ä¸­æ’ç¬¬ä¸€ä½ï¼Œé‚£3å°±åœ¨ç¬¬ä¸€ä½

â€‹           233åœ¨æ–æ³¢é‚£å¥‘æ•°åˆ—ä¸­æ’ç¬¬12ä½ï¼Œé‚£6åœ¨12ä½ä¸Š

```
a = "0 1 2 3 5 8 13 21 34 55 89 144 233 377 610 987 1597 2584 4181 6765 10946 17711 28657 46368 75025 121393 196418 317811 514229 832040 1346269 2178309"
b = "0 233 3 2584 1346269 144 5 196418 21 1597 610 377 10946 89 514229 987 8 55 6765 2178309 121393 317811 46368 4181 1 832040 2 28657 75025 34 13 17711"
a = a.split(" ")
b = b.split(" ")
flag = []
m = "36968853882116725547342176952286"
for i in range(len(a)):
    for j in range(len(a)):    
        if a[i] == b[j]:        #a[i]ä¸­çš„å€¼åœ¨bä¸­çš„ç´¢å¼•ä¸ºj
            #print(j)
            flag.append(m[j])   #å°†m[j]ä¸­çš„å€¼æ·»åŠ åˆ°flagä¸­
print(len(flag))
print(''.join(flag))
#37995588256861228614165223347687

```



### [MRCTF2020]å¤å…¸å¯†ç çŸ¥å¤šå°‘ï¼ˆå¤å…¸å¯†ç å›¾å½¢ï¼‰

![image-20240818205933301](https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202408182059429.png)

è§‚å¯Ÿå›¾ä¸­ä¿¡æ¯ï¼Œå¯ä»¥å‘ç°ç”¨åˆ°äº†CTFä¸­çš„å›¾å½¢å¯†ç ï¼ŒåŒ…æ‹¬[çŒªåœˆå¯†ç çš„å˜å½¢](https://blog.csdn.net/weixin_47869330/article/details/111396033)ã€æ ‡å‡†é“¶æ²³å­—æ¯çš„åŠ å¯†ã€å’Œåœ£å ‚æ­¦å£«å¯†ç ã€‚



æ ‡å‡†é“¶æ²³å­—æ¯çš„åŠ å¯†

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://i-blog.csdnimg.cn/blog_migrate/e1a77fd993f1103879e0ddfdc430cb52.png)

åœ£å ‚æ­¦å£«å¯†ç 

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://i-blog.csdnimg.cn/blog_migrate/6ae09e8d538efed8f9ce7dcbb49b7bcd.png)

è§£å¯†å‡ºæ¥å¾—åˆ°

```
FGCPFLIRTUASYON
```

é¢˜ç›®ä¿¡æ¯è¿˜æåˆ°äº†fenceï¼Œæˆ‘ä»¬è€ƒè™‘æ …æ å¯†ç 

![img](https://img-blog.csdnimg.cn/direct/85bce167029b493ab498df32a8c47706.png)

å¯å¾—åˆ°æœ‰ç”¨ä¿¡æ¯ï¼šFLAGISCRYPTOFUNï¼Œå»æ‰å‰é¢ä¿¡æ¯å¾—æœ€ç»ˆç»“æœä¸ºï¼š

```
flag{CRYPTOFUN}
```



### rot(rotåŸç†)

```
ç ´è§£ä¸‹é¢çš„å¯†æ–‡ï¼š

83 89 78 84 45 86 96 45 115 121 110 116 136 132 132 132 108 128 117 118 134 110 123 111 110 127 108 112 124 122 108 118 128 108 131 114 127 134 108 116 124 124 113 108 76 76 76 76 138 23 90 81 66 71 64 69 114 65 112 64 66 63 69 61 70 114 62 66 61 62 69 67 70 63 61 110 110 112 64 68 62 70 61 112 111 112

flagæ ¼å¼flag{}
```

çœ‹ç€åƒæ˜¯ ascii ç ã€‚

ä½†æ˜¯æœ‰å¤§äº 127 çš„æ•°å­—å­˜åœ¨ï¼Œæ‰€ä»¥è¦å…ˆå¤„ç†ã€‚

é¢˜ç›®åç§°ä¸º rotï¼Œ

```
ROT5ã€ROT13ã€ROT18ã€ROT47 ç¼–ç æ˜¯ä¸€ç§ç®€å•çš„ç å…ƒä½ç½®é¡ºåºæ›¿æ¢æš—ç ã€‚æ­¤ç±»ç¼–ç å…·æœ‰å¯é€†æ€§ï¼Œå¯ä»¥è‡ªæˆ‘è§£å¯†ï¼Œä¸»è¦ç”¨äºåº”å¯¹å¿«é€Ÿæµè§ˆï¼Œæˆ–è€…æ˜¯æœºå™¨çš„è¯»å–ï¼Œè€Œä¸è®©å…¶ç†è§£å…¶æ„ã€‚
 
ROT5 æ˜¯ rotate by 5 places çš„ç®€å†™ï¼Œæ„æ€æ˜¯æ—‹è½¬5ä¸ªä½ç½®ï¼Œå…¶å®ƒçš†åŒã€‚ä¸‹é¢åˆ†åˆ«è¯´è¯´å®ƒä»¬çš„ç¼–ç æ–¹å¼ï¼š
ROT5ï¼šåªå¯¹æ•°å­—è¿›è¡Œç¼–ç ï¼Œç”¨å½“å‰æ•°å­—å¾€å‰æ•°çš„ç¬¬5ä¸ªæ•°å­—æ›¿æ¢å½“å‰æ•°å­—ï¼Œä¾‹å¦‚å½“å‰ä¸º0ï¼Œç¼–ç åå˜æˆ5ï¼Œå½“å‰ä¸º1ï¼Œç¼–ç åå˜æˆ6ï¼Œä»¥æ­¤ç±»æ¨é¡ºåºå¾ªç¯ã€‚
ROT13ï¼šåªå¯¹å­—æ¯è¿›è¡Œç¼–ç ï¼Œç”¨å½“å‰å­—æ¯å¾€å‰æ•°çš„ç¬¬13ä¸ªå­—æ¯æ›¿æ¢å½“å‰å­—æ¯ï¼Œä¾‹å¦‚å½“å‰ä¸ºAï¼Œç¼–ç åå˜æˆNï¼Œå½“å‰ä¸ºBï¼Œç¼–ç åå˜æˆOï¼Œä»¥æ­¤ç±»æ¨é¡ºåºå¾ªç¯ã€‚
ROT18ï¼šè¿™æ˜¯ä¸€ä¸ªå¼‚ç±»ï¼Œæœ¬æ¥æ²¡æœ‰ï¼Œå®ƒæ˜¯å°†ROT5å’ŒROT13ç»„åˆåœ¨ä¸€èµ·ï¼Œä¸ºäº†å¥½ç§°å‘¼ï¼Œå°†å…¶å‘½åä¸ºROT18ã€‚
ROT47ï¼šå¯¹æ•°å­—ã€å­—æ¯ã€å¸¸ç”¨ç¬¦å·è¿›è¡Œç¼–ç ï¼ŒæŒ‰ç…§å®ƒä»¬çš„ASCIIå€¼è¿›è¡Œä½ç½®æ›¿æ¢ï¼Œç”¨å½“å‰å­—ç¬¦ASCIIå€¼å¾€å‰æ•°çš„ç¬¬47ä½å¯¹åº”å­—ç¬¦æ›¿æ¢å½“å‰å­—ç¬¦ï¼Œä¾‹å¦‚å½“å‰ä¸ºå°å†™å­—æ¯zï¼Œç¼–ç åå˜æˆå¤§å†™å­—æ¯Kï¼Œå½“å‰ä¸ºæ•°å­—0ï¼Œç¼–ç åå˜æˆç¬¦å·_ã€‚ç”¨äºROT47ç¼–ç çš„å­—ç¬¦å…¶ASCIIå€¼èŒƒå›´æ˜¯33ï¼126ï¼Œå…·ä½“å¯å‚è€ƒASCIIç¼–ç ã€‚
```

å‚è€ƒrotåŸç†ï¼Œå°†æ‰€æœ‰æ•°å­—å‡13ï¼Œå†è½¬asciiç 

```
s='83 89 78 84 45 86 96 45 115 121 110 116 136 132 132 132 108 128 117 118 134 110 123 111 110 127 108 112 124 122 108 118 128 108 131 114 127 134 108 116 124 124 113 108 76 76 76 76 138 23 90 81 66 71 64 69 114 65 112 64 66 63 69 61 70 114 62 66 61 62 69 67 70 63 61 110 110 112 64 68 62 70 61 112 111 112'
l = s.split(" ")
for i in l:
    print(chr(int(i) - 13), end='')
```

```
FLAG IS flag{www_shiyanbar_com_is_very_good_????}
MD5:38e4c352809e150186920aac37190cbc
```

çœ‹æ ·å­æˆ‘ä»¬éœ€è¦å¯¹flagçš„æœ€å4ä½è¿›è¡Œçˆ†ç ´

```python
demo='flag{www_shiyanbar_com_is_very_good_'
check = '38e4c352809e150186920aac37190cbc'
 
for i in range(32,126):
    for j in range(32,126):
        for k in range(32,126):
            for m in range(32,126):
                tmp = demo + chr(i) + chr(j) + chr(k) + chr(m) + '}'
                hash = hashlib.md5(tmp.encode('utf8')).hexdigest()
                if check == hash:
                    print(tmp)
                    exit()
```

å¾—åˆ°flag



### è¿™æ˜¯ä»€ä¹ˆ(jsfuck)

æˆ‘ä»¬å°†apkæ–‡ä»¶ä¿®æ”¹ä¸ºtxtæ–‡ä»¶

æˆ‘ä»¬åœ¨æ–‡ä»¶ä¸­å‘ç°

![image-20240818212431110](https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202408182124165.png)

æˆ‘ä»¬è€ƒè™‘jsfuckè§£å¯†

æˆ‘ä»¬f12æ‰“å¼€æ§åˆ¶å°ï¼Œå°†æ‹¬å·å¤åˆ¶è¿›å»

![image-20240818212531846](https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202408182125216.png)

å¾—åˆ°flag



### [MRCTF2020]å¤©å¹²åœ°æ”¯+ç”²å­ï¼ˆå¤©å¹²åœ°æ”¯ï¼‰

![image-20240902205011081](https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202409022050164.png)

```
å…­åå¹´ç”²å­ï¼ˆå¹²æ”¯è¡¨ï¼‰
1	      2	     3	      4	     5	     6	     7	     8	     9	     10
ç”²å­	ä¹™ä¸‘	ä¸™å¯…	ä¸å¯	æˆŠè¾°	å·±å·³	åºšåˆ	è¾›æœª	å£¬ç”³	ç™¸é…‰
11	     12  	 13	     14 	 15 	 16	     17	     18	     19	     20
ç”²æˆŒ	ä¹™äº¥	ä¸™å­	ä¸ä¸‘	æˆŠå¯…	å·±å¯	åºšè¾°	è¾›å·³	å£¬åˆ	ç™¸æœª
21	     22    	 23	     24	     25	     26      27	     28	     29	     30
ç”²ç”³	ä¹™é…‰	ä¸™æˆŒ	ä¸äº¥	æˆŠå­	å·±ä¸‘	åºšå¯…	è¾›å¯	å£¬è¾°	ç™¸å·³
31	     32	     33	     34	     35	     36	     37	     38	     39      40
ç”²åˆ	ä¹™æœª	ä¸™ç”³	ä¸é…‰	æˆŠæˆŒ	å·±äº¥	åºšå­	è¾›ä¸‘	å£¬å¯…	ç™¸å¯
41	     42	     43	     44	     45	     46	     47	     48	     49      50
ç”²è¾°	ä¹™å·³	ä¸™åˆ	ä¸æœª	æˆŠç”³	å·±é…‰	åºšæˆŒ	è¾›äº¥	å£¬å­	ç™¸ä¸‘
51	     52	     53	     54	     55	     56	     57	     58	     59      60
ç”²å¯…	ä¹™å¯	ä¸™è¾°	ä¸å·³	æˆŠåˆ	å·±æœª	åºšç”³	è¾›é…‰	å£¬æˆŒ	ç™¸äº¥

```

æˆ‘ä»¬å¯¹ç…§å¾—åˆ°

```
11  51  51  40  46  51  38
```

éƒ½åŠ ä¸€ä¸ªç”²å­(60)å¾—åˆ°

```
71 111 111 100 106 111 98
```

æˆ‘ä»¬å¯¹ç…§asciiè¡¨å¾—åˆ°

![ASCIIç è¡¨](https://i-blog.csdnimg.cn/blog_migrate/ed5595d40998e6bd7aff7e6c286dd338.png)

```
Goodjob

```

å¾—åˆ°flag

```
flag{Goodjob}
```

### [NCTF2019]Keyboard(è„‘æ´)

![image-20240902210112608](https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202409022101648.png)

é¢˜ç›®æç¤ºé”®ç›˜ï¼Œæˆ‘ä»¬å‘ç°æ¯ä¸€ä¸ªå­—æ¯éƒ½å¯¹åº”ä¸Šé¢çš„ä¸€ä¸ªæ•°å­—ï¼Œæˆ‘ä»¬çŒœæµ‹9é”®ç›˜ï¼Œè€Œå­—æ¯ä¸ªæ•°å°±æ˜¯å¯¹åº”çš„9é”®ç›˜ä¸Šçš„å¯¹åº”çš„å­—æ¯

```
youaresosmartthatthisisjustapieceofcake

```

```python
cipher="ooo yyy ii w uuu ee uuuu yyy uuuu y w uuu i i rr w i i rr rrr uuuu rrr uuuu t ii uuuu i w u rrr ee www ee yyy eee www w tt ee"
base=" qwertyuiop"
a=[" "," ","abc","def","ghi","jkl","mno","pqrs","tuv","wxyz"]
for part in cipher.split(" "):
    s=base.index(part[0])
    count=len(part)
    print(a[s][count-1],end="")

```



### [BJDCTF2020]signin

![image-20240902214954471](https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202409022149533.png)

æˆ‘ä»¬è§‚å¯Ÿï¼Œå¯†æ–‡ä¸º16è¿›åˆ¶ï¼Œæˆ‘ä»¬å°†å…¶è½¬æ¢ä¸ºå­—ç¬¦

```python
from Crypto.Util.number import *
a=0x424a447b57653163306d655f74345f424a444354467d
c=long_to_bytes((a))
print(c.decode("utf-8"))
```

å¾—åˆ°flag

```
BJD{We1c0me_t4_BJDCTF}
```

### [MRCTF2020]vigenereï¼ˆç»´å‰å°¼äºšè§£å¯†ï¼‰

æˆ‘ä»¬æ‰¾ä¸€ä¸ªåœ¨çº¿ç½‘ç«™

https://www.guballa.de/vigenere-solver

æŠŠæ–‡æœ¬æ”¾ä¸Šå»ï¼Œç›´æ¥ç ´è§£ï¼Œflagæ˜¯æœ€åä¸€è¡Œ

![image-20240905212644646](https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202409052126846.png)

### [ACTFæ–°ç”Ÿèµ›2020]crypto-rsa0(zipä¼ªåŠ å¯†)

æˆ‘ä»¬æŠŠæ–‡ä»¶ä¸‹ä¸‹æ¥åï¼Œåœ¨hint.txtæç¤ºï¼Œæ–‡ä»¶è¿›è¡Œäº†zipä¼ªåŠ å¯†

![image-20240905215448375](https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202409052154418.png)

ä¸€ä¸ªZIPæ–‡ä»¶ç”±ä¸‰ä¸ªéƒ¨åˆ†ç»„æˆï¼š



å‹ç¼©æºæ–‡ä»¶æ•°æ®åŒº+å‹ç¼©æºæ–‡ä»¶ç›®å½•åŒº+å‹ç¼©æºæ–‡ä»¶ç›®å½•ç»“æŸæ ‡å¿—ã€‚

ä¼ªåŠ å¯†åŸç†ï¼šzipä¼ªåŠ å¯†æ˜¯åœ¨æ–‡ä»¶å¤´çš„åŠ å¯†æ ‡å¿—ä½åšä¿®æ”¹ï¼Œè¿›è€Œå†æ‰“å¼€æ–‡ä»¶æ—¶è¯†è¢«åˆ«ä¸ºåŠ å¯†å‹ç¼©åŒ…ã€‚ ä¸€èˆ¬æ¥è¯´ï¼Œæ–‡ä»¶å„ä¸ªåŒºåŸŸå¼€å¤´å°±æ˜¯50 4Bï¼Œç„¶ååé¢ä¸¤ä¸ªå­—èŠ‚æ˜¯ç‰ˆæœ¬ï¼Œå†åé¢ä¸¤ä¸ªå°±æ˜¯åˆ¤æ–­æ˜¯å¦æœ‰åŠ å¯†çš„å…³é”®äº†

ä¼ªåŠ å¯†ï¼š

å‹ç¼©æºæ–‡ä»¶æ•°æ®åŒºçš„å…¨å±€åŠ å¯†åº”å½“ä¸º 00 00

ä¸”å‹ç¼©æ–‡ä»¶ç›®å½•åŒºçš„å…¨å±€æ–¹å¼æ ‡è®°åº”å½“ä¸º 09 00

#### åŸç†

ZIPä¼ªåŠ å¯†æ˜¯åœ¨æ–‡ä»¶å¤´çš„åŠ å¯†æ ‡å¿—ä½åšä¿®æ”¹ï¼Œè¿›è€Œå†æ‰“å¼€æ–‡ä»¶æ—¶è¯†åˆ«ä¸ºåŠ å¯†å‹ç¼©åŒ…ã€‚
åœ¨å‚è€ƒäº†ç½‘ä¸Šå¤šæ•°æ–‡ç« æ— æœåï¼Œåœ¨è¥¿æ™®çš„ä¸€ä¸ªå°é¢˜æ‰¾åˆ°äº†å¯ä»¥å¤ç°çš„æ–¹æ³•ã€‚
ç»™å‡ºè¥¿æ™®çš„æŸä¸ªç¤ºä¾‹ï¼š

```python
å‹ç¼©æºæ–‡ä»¶æ•°æ®åŒº 
50 4B 03 04ï¼šè¿™æ˜¯å¤´æ–‡ä»¶æ ‡è®°ï¼ˆ0x04034b50ï¼‰
14 00ï¼šè§£å‹æ–‡ä»¶æ‰€éœ€ pkware ç‰ˆæœ¬ 
00 00ï¼šå…¨å±€æ–¹å¼ä½æ ‡è®°ï¼ˆæœ‰æ— åŠ å¯†ï¼‰ 
08 00ï¼šå‹ç¼©æ–¹å¼ 
5A 7Eï¼šæœ€åä¿®æ”¹æ–‡ä»¶æ—¶é—´ 
F7 46ï¼šæœ€åä¿®æ”¹æ–‡ä»¶æ—¥æœŸ 
16 B5 80 14ï¼šCRC-32æ ¡éªŒï¼ˆ1480B516ï¼‰
19 00 00 00ï¼šå‹ç¼©åå°ºå¯¸ï¼ˆ25ï¼‰
17 00 00 00ï¼šæœªå‹ç¼©å°ºå¯¸ï¼ˆ23ï¼‰
07 00ï¼šæ–‡ä»¶åé•¿åº¦ 
00 00ï¼šæ‰©å±•è®°å½•é•¿åº¦ 
6B65792E7478740BCECC750E71ABCE48CDC9C95728CECC2DC849AD284DAD0500  
å‹ç¼©æºæ–‡ä»¶ç›®å½•åŒº 
50 4B 01 02ï¼šç›®å½•ä¸­æ–‡ä»¶æ–‡ä»¶å¤´æ ‡è®°(0x02014b50)  
3F 00ï¼šå‹ç¼©ä½¿ç”¨çš„ pkware ç‰ˆæœ¬ 
14 00ï¼šè§£å‹æ–‡ä»¶æ‰€éœ€ pkware ç‰ˆæœ¬ 
00 00ï¼šå…¨å±€æ–¹å¼ä½æ ‡è®°ï¼ˆæœ‰æ— åŠ å¯†ï¼Œè¿™ä¸ªæ›´æ”¹è¿™é‡Œè¿›è¡Œä¼ªåŠ å¯†ï¼Œæ”¹ä¸º09 00æ‰“å¼€å°±ä¼šæç¤ºæœ‰å¯†ç äº†ï¼‰ 
08 00ï¼šå‹ç¼©æ–¹å¼ 
5A 7Eï¼šæœ€åä¿®æ”¹æ–‡ä»¶æ—¶é—´ 
F7 46ï¼šæœ€åä¿®æ”¹æ–‡ä»¶æ—¥æœŸ 
16 B5 80 14ï¼šCRC-32æ ¡éªŒï¼ˆ1480B516ï¼‰
19 00 00 00ï¼šå‹ç¼©åå°ºå¯¸ï¼ˆ25ï¼‰
17 00 00 00ï¼šæœªå‹ç¼©å°ºå¯¸ï¼ˆ23ï¼‰
07 00ï¼šæ–‡ä»¶åé•¿åº¦ 
24 00ï¼šæ‰©å±•å­—æ®µé•¿åº¦ 
00 00ï¼šæ–‡ä»¶æ³¨é‡Šé•¿åº¦ 
00 00ï¼šç£ç›˜å¼€å§‹å· 
00 00ï¼šå†…éƒ¨æ–‡ä»¶å±æ€§ 
20 00 00 00ï¼šå¤–éƒ¨æ–‡ä»¶å±æ€§ 
00 00 00 00ï¼šå±€éƒ¨å¤´éƒ¨åç§»é‡ 
6B65792E7478740A00200000000000010018006558F04A1CC5D001BDEBDD3B1CC5D001BDEBDD3B1CC5D001  
å‹ç¼©æºæ–‡ä»¶ç›®å½•ç»“æŸæ ‡å¿— 
50 4B 05 06ï¼šç›®å½•ç»“æŸæ ‡è®° 
00 00ï¼šå½“å‰ç£ç›˜ç¼–å· 
00 00ï¼šç›®å½•åŒºå¼€å§‹ç£ç›˜ç¼–å· 
01 00ï¼šæœ¬ç£ç›˜ä¸Šçºªå½•æ€»æ•° 
01 00ï¼šç›®å½•åŒºä¸­çºªå½•æ€»æ•° 
59 00 00 00ï¼šç›®å½•åŒºå°ºå¯¸å¤§å° 
3E 00 00 00ï¼šç›®å½•åŒºå¯¹ç¬¬ä¸€å¼ ç£ç›˜çš„åç§»é‡ 
00 00ï¼šZIP æ–‡ä»¶æ³¨é‡Šé•¿åº¦
		æˆ‘ä»¬ç”¨010æ‰“å¼€zipæ–‡ä»¶ï¼ŒæŠŠæ‰€æœ‰çš„50 4Båçš„09 00éƒ½æ”¹æˆ00 00
```

![image-20240905215619133](https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202409052156325.png)

ä¿å­˜ä¹‹åæ‰“å¼€å‹ç¼©åŒ…ï¼Œå‘å‘ç°å°±å¯ä»¥é¡ºåˆ©æ‰“å¼€rsa.pyæ–‡ä»¶äº†

ç„¶åå°±æ˜¯ä¸ªrsaè§£å¯†äº†

```python
import binascii
import gmpy2
import binascii

p = 9018588066434206377240277162476739271386240173088676526295315163990968347022922841299128274551482926490908399237153883494964743436193853978459947060210411
q = 7547005673877738257835729760037765213340036696350766324229143613179932145122130685778504062410137043635958208805698698169847293520149572605026492751740223
c = 50996206925961019415256003394743594106061473865032792073035954925875056079762626648452348856255575840166640519334862690063949316515750256545937498213476286637455803452890781264446030732369871044870359838568618176586206041055000297981733272816089806014400846392307742065559331874972274844992047849472203390350
e = 65537

n = p * q
phi_n = (q - 1) * (p - 1)
d = gmpy2.invert(e, phi_n)
m = gmpy2.powmod(c, d, n)

print(binascii.unhexlify(hex(m)[10:]))
```

### ä¼ æ„Ÿå™¨ï¼ˆæ›¼å½»æ–¯ç‰¹ç¼–ç ï¼‰

###### Wiki

æ›¼å½»æ–¯ç‰¹ç¼–ç ï¼ˆManchester Encodingï¼‰ï¼Œä¹Ÿå«åšç›¸ä½ç¼–ç ï¼ˆ Phase Encodeï¼Œç®€å†™PEï¼‰ï¼Œæ˜¯ä¸€ä¸ªåŒæ­¥æ—¶é’Ÿç¼–ç æŠ€æœ¯ï¼Œè¢«ç‰©ç†å±‚ä½¿ç”¨æ¥ç¼–ç ä¸€ä¸ªåŒæ­¥ä½æµçš„æ—¶é’Ÿå’Œæ•°æ®ã€‚å®ƒåœ¨ä»¥å¤ªç½‘åª’ä»‹ç³»ç»Ÿä¸­çš„åº”ç”¨å±äºæ•°æ®é€šä¿¡ä¸­çš„ä¸¤ç§ä½åŒæ­¥æ–¹æ³•é‡Œçš„è‡ªåŒæ­¥æ³•ï¼ˆå¦ä¸€ç§æ˜¯å¤–åŒæ­¥æ³•ï¼‰ï¼Œå³æ¥æ”¶æ–¹åˆ©ç”¨åŒ…å«æœ‰åŒæ­¥ä¿¡å·çš„ç‰¹æ®Šç¼–ç ä»ä¿¡å·è‡ªèº«æå–åŒæ­¥ä¿¡å·æ¥é”å®šè‡ªå·±çš„æ—¶é’Ÿè„‰å†²é¢‘ç‡ï¼Œè¾¾åˆ°åŒæ­¥ç›®çš„ã€‚

###### Encode and Decode

IEEE 802.4ï¼ˆä»¤ç‰Œæ€»çº¿ï¼‰å’Œä½é€Ÿç‰ˆçš„IEEE 802.3ï¼ˆä»¥å¤ªç½‘ï¼‰ä¸­è§„å®š, æŒ‰ç…§è¿™æ ·çš„è¯´æ³•, 01ç”µå¹³è·³å˜è¡¨ç¤º1, 10çš„ç”µå¹³è·³å˜è¡¨ç¤º0ã€‚

###### Ideas

```python
5555555595555A65556AA696AA6666666955`è½¬ä¸ºäºŒè¿›åˆ¶ï¼Œæ ¹æ®01->1,10->0ã€‚å¯å¾—åˆ°
0101->11
0110->10
1010->00
1001->01
decodeå¾—åˆ°
`11111111 11111111 01111111 11001011 11111000 00100110 00001010 10101010 10011111`
bin->hexï¼Œå¯¹æ¯”IDå¹¶ä¸é‡åˆï¼Œæ ¹æ®å…«ä½å€’åºä¼ è¾“åè®®å°†äºŒè¿›åˆ¶æ¯å…«ä½reverseï¼Œè½¬hexå³å¯
flagï¼š`FFFFFED31F645055F9
```

```python
cipher='5555555595555A65556AA696AA6666666955'
def iee(cipher):
    tmp=''
    for i in range(len(cipher)):
        a=bin(eval('0x'+cipher[i]))[2:].zfill(4)
        tmp=tmp+a[1]+a[3]
        print(tmp)
    plain=[hex(int(tmp[i:i+8][::-1],2))[2:] for i in range(0,len(tmp),8)]
    print(''.join(plain).upper())

iee(cipher)
```

### [NPUCTF2020]è¿™æ˜¯ä»€ä¹ˆè§…ğŸï¼ˆè§‚å¯Ÿï¼‰

ç”¨è®°äº‹æœ¬æ‰“å¼€æ˜¯ä¸ªä¹±ç Â·

![image-20240909151824355](https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202409091518136.png)

ä½†æˆ‘ä»¬çœ‹åˆ°å¼€å¤´é‚£ä¸ªpkï¼Œæˆ‘ä»¬æƒ³åˆ°zipæ–‡ä»¶ï¼Œæˆ‘ä»¬å°†åç¼€æ”¹ä¸ºzipï¼ŒæˆåŠŸæ‰“å¼€æ–‡ä»¶

![image-20240909151910551](https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202409091519299.png)

çœ‹åˆ°æœ‰ä¸€ä¸ªå­—æ¡å’Œæ—¥å†ï¼ŒçŒœæµ‹æ˜¯ç±»ä¼¼çŸ©é˜µçš„åŸç†,

```
F1 W1 S22 S21 T12 S11 W1 S13
```

ä¸¤ä¸ªsåº”è¯¥æ˜¯s1å¯¹åº”å‘¨å…­ï¼Œs2å¯¹åº”å‘¨æ—¥

å­—æ¯æœ€åçš„æ•°å­—å¯¹åº”æ‰€åœ¨çš„è¡Œæ•°

ä¾‹å¦‚F1ï¼Œç¬¬ä¸€è¡Œçš„æ˜ŸæœŸäº”

```
 3 1 12 5 14 4 1 18
```

å¯¹ç…§å­—æ¯è¡¨ calendarï¼Œflag{calendar}



### æµªé‡Œæ·˜æ²™ï¼ˆè„‘æ´ï¼‰

æ‰“å¼€txtæ–‡æ¡£å‘ç°å¤§é‡çš„å•è¯ï¼Œå†ç»“åˆé¢˜ç›®ç»™åˆ°çš„ä¸€ä¸²æ•°å­—4ã€8ã€11ã€15ã€16å¯ä»¥è€ƒè™‘åˆ°æ˜¯è·Ÿå­—é¢‘æœ‰å…³

æˆ‘ä»¬æ‰“å¼€ä¸‡èƒ½çš„wpsè¿›è¡ŒæŸ¥è¯¢

![image-20240914150507182](https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202409141505435.png)

ç„¶åæ”¾åˆ°excelè¿›è¡Œæ’åº

![image-20240914150532083](https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202409141505231.png)

æ ‡æ³¨èµ·é¢˜ç›®è¦æ±‚çš„ç¼–å·ç»„åˆèµ·å­—ç¬¦ä¸²å³å¯å¾—åˆ°flag

flag{weshouldlearnthecrypto}

### [WUSTCTF2020]B@seï¼ˆbase64å˜è¡¨&æ’åˆ—ç»„åˆï¼‰

é¢˜ç›®é™„ä»¶å†…å®¹ï¼š

![image-20241022191416972](https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202410221914034.png)

 

 é¦–å…ˆé€šè¿‡è§‚å¯Ÿé¢˜ç›®å­—ç¬¦ç‰¹å¾å¾ˆæ˜æ˜¾æ˜¯base64ç¼–ç ï¼Œç¬¬ä¸€è¡Œçš„å¯†æ–‡æ˜¯é€šè¿‡ä¸‹é¢ç»™çš„base64çš„å˜è¡¨ï¼Œä½†æ˜¯ä»”ç»†è§‚å¯Ÿç¼ºå°‘äº†å››ä¸ªå­—ç¬¦ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦å†™è„šæœ¬æŠŠç¼ºå°‘çš„å­—ç¬¦ç»™è¿˜åŸå‡ºæ¥

çˆ†ç ´è„šæœ¬ï¼š

```python
import string
c = 'JASGBWcQPRXEFLbCDIlmnHUVKTYZdMovwipatNOefghq56rs****kxyz012789+/'
for i in string.ascii_letters + string.digits:  # string.ascii_lettersæ‰€æœ‰å­—æ¯  string.digitsæ‰€æœ‰æ•°å­—
    if(i not in c):
        print(i,end='')
# ju34

å¾ˆæ˜æ˜¾çˆ†ç ´å‡ºæ¥çš„æ˜¯â€œju34â€ï¼Œä½†æ˜¯æˆ‘ä»¬è¿˜ä¸çŸ¥é“ä»–çš„åŸå§‹æ’åˆ—çš„é¡ºåºæ˜¯ä»€ä¹ˆï¼Ÿï¼Œå› æ­¤éœ€è¦æˆ‘ä»¬å¯¹ç€å››ä¸ªå­—ç¬¦ä¸å¯†æ–‡è¿›è¡Œä¸€ä¸ªæ’åˆ—ç»„åˆï¼Œå¹¶å¯ä»¥è§£å‡ºæ˜æ–‡ã€‚
ä»£ç å¦‚ä¸‹ï¼ˆè¿™é‡Œæ˜¯å‚è€ƒäº†ä¸€äº›å¤§ä½¬çš„è„šæœ¬ï¼‰ï¼š
import binascii
import itertools
cipher = 'MyLkTaP3FaA7KOWjTmKkVjWjVzKjdeNvTnAjoH9iZOIvTeHbvD' # å…¨æ’åˆ—ç»„åˆ
s = ['j','u','3','4']
for i in itertools.permutations(s,4): # 4å°±æ˜¯æŠŠsåˆ—è¡¨é‡Œçš„å­—æ¯4ä¸ªä¸ºä¸€ç»„æ’åˆ—
    k = "JASGBWcQPRXEFLbCDIlmnHUVKTYZdMovwipatNOefghq56rs"+ "".join(i) + "kxyz012789+/"  # "".join(i)æ’åˆ—çš„ç»“æœï¼ˆjoin() æ–¹æ³•ç”¨äºå°†åºåˆ—ä¸­çš„å…ƒç´ ä»¥æŒ‡å®šçš„å­—ç¬¦è¿æ¥ç”Ÿæˆä¸€ä¸ªæ–°çš„å­—ç¬¦ä¸²ï¼‰
    a = ""
    for j in cipher:
        a += bin(k.index(j))[2:].zfill(6)
    print(binascii.a2b_hex(hex(eval("0b"+a))[2:-1]))  # a2b_hexå’Œbinascii.unhexlifyå¯ä»¥ä¸º16è¿›åˆ¶çš„ bytes ç±»å‹ï¼Œä¹Ÿå¯ä»¥ä¸ºåå…­è¿›åˆ¶ str ç±»å‹
                                                      # ä¸¾ä¾‹ï¼šè¿™é‡Œè½¬ä¸º16è¿›åˆ¶åä¼šå‡ºç°0x471Lï¼Œæ‰€ä»¥åªæœ‰å»æ‰0xå’ŒLå°±æœ‰äº†[2:-1]

è¿è¡Œç»“æœï¼š
```

![img](https://img2023.cnblogs.com/blog/3039513/202212/3039513-20221204153422960-573637136.png)

 

 

 å¾ˆæ˜æ˜¾å›¾ä¸­æ¡†å‡ºæ¥çš„åœ°æ–¹å°±æ˜¯æœ€åçš„flagå€¼

æ€»ç»“ï¼šæ­¤é¢˜è€ƒå¯Ÿäº†ç¼ºæŸçš„base64å˜è¡¨ï¼Œéœ€è¦ä½¿ç”¨çˆ†ç ´è„šæœ¬ç ´è§£å‡ºæ˜æ–‡ã€‚



### [AFCTF2018]Singleï¼ˆçˆ†ç ´ï¼‰

æˆ‘ä»¬ä¸‹è½½é™„ä»¶ï¼Œå‘ç°é‡Œé¢æœ‰ä¸ªcè¯­è¨€ç¨‹åºå’Œä¸€ä¸ªæ–‡ä»¶

é€šè¿‡ä»£ç åˆ†æï¼Œæˆ‘ä»¬å‘ç°Cipher.txtæ˜¯ä¸€ä¸ªåŠ å¯†åçš„æ–‡ä»¶ï¼Œä»”ç»†è§‚å¯Ÿï¼Œå¾ˆæ˜æ˜¾ç¤ºæ˜¯ä¸€ä¸ªæ— è§„å¾‹æ›¿æ¢åŠ å¯†ï¼Œæˆ‘ä»¬ä½¿ç”¨è¯é¢‘åˆ†æ

ç½‘ç«™ï¼šhttp://quipqiup.com/

å¾—åˆ°flag

![image-20240926192619737](https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202409261926862.png)

æˆ–è€…æˆ‘ä»¬é€†å‘è¾“å‡º

```python
#include <bits/stdc++.h>
using namespace std;
int main()
{
	freopen("Cipher.txt","r",stdin);//è¾“å…¥è¾“å‡ºæ¢ä¸€ä¸‹
	freopen("Plain.txt","w",stdout);//è¾“å…¥è¾“å‡ºæ¢ä¸€ä¸‹
	map<char, char> f;
	int arr[26];
	for(int i=0;i<26;++i){
		arr[i]=i;
	}
	random_shuffle(arr,arr+26);
	for(int i=0;i<26;++i){
		f['a'+i]='a'+arr[i];
		f['A'+i]='A'+arr[i];
	}
	char ch;
	while((ch=getchar())!=EOF){
		if(f.count(ch)){
            //åå‘è½¬æ¢ä¸€ä¸‹ï¼Œé€šè¿‡value>>key
			for(map<char,char>::iterator it = f.begin();it!=f.end();it++)
			{
				if(it->second == ch)
				{
				  putchar(it->first);
				  break;
				}
			}
		}else{
			putchar(ch);
		}
	}
	return 0;
}
```

å¾—åˆ°åŠ å¯†å‰çš„æ–‡ä»¶ï¼Œæ‰¾åˆ°flag



### é¸¡è—•æ¤’ç›å‘³ï¼ˆæµ·æ˜æ ¡éªŒç ï¼‰

![image-20241009211038399](https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202410092110584.png)

1.åˆ†ææ ¡éªŒä½æ•°

ä»é¢˜ç›®å¯çŸ¥éªŒè¯ç ä¸º110010100000å…±12ä½ï¼Œæ ¡éªŒä½ä¸€èˆ¬éƒ½æ˜¯åœ¨2^nçš„ä½ç½®ï¼Œæ‰€ä»¥å…±æœ‰4ä½æ ¡éªŒç åœ¨1ï¼Œ2ï¼Œ4ï¼Œ8ä½ç½®

æ‹“å±•ï¼šæµ·æ˜éªŒè¯ç å…¬å¼ï¼š2^râ‰¥k+r+1  ï¼ˆrä¸ºæ ¡éªŒä½ ï¼Œkä¸ºä¿¡æ¯ä½ï¼‰ï¼Œå¦‚æœ¬éªŒè¯ç æœ¬æ¥æœ‰8ä½ä¿¡æ¯ç ï¼Œå¸¦å…¥å…¬å¼å¯å¾—r=4ï¼Œæ‰€ä»¥åœ¨1ï¼Œ2ï¼Œ4ï¼Œ8ä½ç½®æ·»åŠ ç›¸åº”æ ¡éªŒç 

2.ç”»è¡¨

é¢˜ç›®ä¸­æåˆ°æ‰“å°çš„æ—¶å€™å€’äº†ä¸€ä¸‹ï¼Œæ‰€ä»¥å°†ä¿¡æ¯ä½å€’ç€å¡«å…¥è¡¨ä¸­

| 1    | 2    | 3    | 4    | 5    | 6    | 7    | 8    | 9    | 10   | 11   | 12   | ä½æ•°        |
| ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ----------- |
|      |      | 0    |      | 0    | 1    | 0    |      | 0    | 0    | 1    | 1    | ä¿¡æ¯ä½ï¼ˆDï¼‰ |
| R1   | R2   |      | R3   |      |      |      | R4   |      |      |      |      | æ ¡éªŒä½ï¼ˆRï¼‰ |

3.æ±‚æ ¡éªŒä½çš„å€¼

ä¾‹å¦‚ï¼š1ç”±ç¬¬ä¸€ä½R1æ¥æ ¡éªŒï¼›2ç”±ç¬¬äºŒä½R2æ¥æ ¡éªŒï¼›ç”±äº3=1+2ï¼ˆ1å’Œ2æŒ‡çš„æ˜¯ä½æ•°ï¼Œéƒ½æ˜¯2çš„næ¬¡æ–¹ï¼‰æ‰€ä»¥3ç”±ç¬¬ä¸€ä½R1å’Œç¬¬äºŒä½R2æ ¡éªŒï¼Œ4ç”±ç¬¬å››ä½R3æ ¡éªŒï¼Œ5å’Œ3é“ç†æ˜¯ä¸€æ ·çš„ï¼Œ5=1+4ï¼ˆ2^0+2^2ï¼‰;6=2+4;7=1+2+4ï¼Œä¾æ¬¡ç±»æ¨ã€‚å¾—å‡ºä¸‹è¡¨ï¼š

| æµ·æ˜ç ä½å· | å ç”¨çš„æ ¡éªŒä½å· | æ ¡éªŒä½     |
| ---------- | -------------- | ---------- |
| 1          | 1              | R1         |
| 2          | 2              | R2         |
| 3          | 1ã€2           | R1ã€R2     |
| 4          | 4              | R3         |
| 5          | 1ã€4           | R1ã€R3     |
| 6          | 2ã€4           | R2ã€R3     |
| 7          | 1ã€2ã€4        | R1ã€R2ã€R3 |
| 8          | 8              | R4         |
| 9          | 1ã€8           | R1ã€R4     |
| 10         | 2ã€8           | R2ã€R4     |
| 11         | 1ã€2ã€8        | R1ã€R2ã€R4 |
| 12         | 4ã€8           | R3ã€R4     |

è¿›è¡Œæ±‡æ€»ï¼Œçœ‹æ¯ä¸ªæ ¡éªŒä½éƒ½ç¡®å®šäº†å“ªä¸€ä½ã€‚ 

R1ï¼š1ã€3ã€5ã€7ã€9ã€11

R2ï¼š2ã€3ã€6ã€7ã€10ã€11

R3ï¼š4ã€5ã€6ã€7ã€12

R4ï¼š9ã€10ã€11ã€12

æœ€åç”¨å¼‚æˆ–è¿ç®—æ±‚å‡ºR1ã€R2ã€R3ã€R4ã€R5çš„å€¼ï¼ˆä»¥R1ä¸ºä¾‹ï¼‰ï¼š

R1=D1âŠ•D3âŠ•D5âŠ•D7âŠ•D9âŠ•D11=1

ä»¥æ­¤ç±»æ¨ï¼šR1=1,R2=0,R3=0,R4=0

å¯ä»¥çœ‹åˆ°P1P2P3P4=0001,R1R2R3R4=1000

å¯ä»¥æ±‚å¾—ç›‘ç£ä½ï¼ˆå¼‚æˆ–ï¼‰ï¼š

| 0    | 0    | 0    | 1    | éªŒè¯ç ä¸­çš„æ ¡éªŒç  |
| ---- | ---- | ---- | ---- | ---------------- |
| 1    | 0    | 0    | 0    | æ±‚å¾—çš„æ ¡éªŒç      |
| 1    | 0    | 0    | 1    | ç›‘ç£ä½           |

ç›‘ç£ä½ä¸ä¸º0000ï¼Œè¯´æ˜æ¥æ”¶æ–¹ç”Ÿæˆçš„æ ¡éªŒä½å’Œæ”¶åˆ°çš„æ ¡éªŒä½ä¸åŒï¼Œé”™è¯¯çš„ä½æ•°æ˜¯ç›‘ç£ä½çš„åè¿›åˆ¶å³9ï¼Œæ‰€ä»¥æŠŠD9å°±æ˜¯é¢˜ç›®ä¸­æåˆ°çš„é”™è¯¯ï¼Œå¾—åˆ°æ­£ç¡®éªŒè¯ç 110110100000ï¼Œç„¶åæ ¹æ®æç¤ºMD5hashä¸€ä¸‹å°±å‡ºæ¥äº†ã€‚



```python
1 import hashlib
2 c="110110100000"
3 md=hashlib.md5()
4 md.update(c.encode("utf8"))
5 flag = md.hexdigest()
6 print(flag)
7 
8 #d14084c7ceca6359eaac6df3c234dd3b
```

 

å¥—å…¥flag{}å³å¯å¾—åˆ°ç­”æ¡ˆflag{d14084c7ceca6359eaac6df3c234dd3b}

### [AFCTF2018]BASE(base16,32,64è§£å¯†)

æˆ‘ä»¬éšä¾¿æˆªå–æ–‡ä»¶çš„ä¸€æ®µå†…å®¹ï¼Œå‘ç°èƒ½è¿›è¡Œå¤šæ®µbase64è§£å¯†

æˆ‘ä»¬æ‰¾ä¸ªè„šæœ¬

```python
import re
import base64
s=open('flag_encode.txt','rb').read()
base16_dic = r'^[A-F0-9=]*$'
base32_dic = r'^[A-Z2-7=]*$'
base64_dic = r'^[A-Za-z0-9/+=]*$'
n= 0
while True:
    n += 1
    t = s.decode()
    if '{' in t:
        print(t)
        break
    elif re.match(base16_dic, t):
        s = base64.b16decode(s)
        print(str(n) + ' base16')
    elif re.match(base32_dic, t):
        s = base64.b32decode(s)
        print(str(n) + ' base32')
    elif re.match(base64_dic, t):
        s = base64.b64decode(s)
        print(str(n) + ' base64')

```



### [BJDCTF2020]Polybius(æ³¢åˆ©æ¯”å¥¥æ–¯æ–¹é˜µå¯†ç )

ç”±é¢˜ç›®æˆ‘ä»¬çŸ¥é“è¿™ä¸ªé¢˜ç›®çš„è€ƒç‚¹æ˜¯æ³¢åˆ©æ¯”å¥¥æ–¯æ–¹é˜µ

Polybiusæ ¡éªŒè¡¨å¦‚ä¸‹

![image-20241106212727853](https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202411062127974.png)

> (2,4)è¿™ä¸ªåæ ‡æ—¢å¯ä»¥è¡¨ç¤ºi ä¹Ÿå¯ä»¥è¡¨ç¤º jå› æ­¤ç ´è§£çš„æ—¶å€™è¿™é‡Œåˆä¼šå¤šä¸¤ç§æƒ…å†µ

------

æˆ‘ä»¬æ¥åº·ä¸ªä¾‹å­

å‡è®¾æ˜æ–‡åºåˆ—ä¸ºattack at onceï¼Œä½¿ç”¨ä¸€å¥—ç§˜å¯†æ··æ‚çš„å­—æ¯è¡¨å¡«æ»¡æ³¢åˆ©æ¯”å¥¥æ–¯æ–¹é˜µ

å¦‚ä¸‹

![image-20241106213011152](https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202411062130236.png)

> 1. i å’Œ jè§†ä¸ºåŒä¸€æ ¼
> 2. é€‰æ‹©è¿™äº”ä¸ªå­—æ¯ï¼Œæ˜¯å› ä¸ºå®ƒä»¬è¯‘æˆæ‘©æ–¯å¯†ç æ—¶ä¸å®¹æ˜“æ··æ·†ï¼Œå¯ä»¥é™ä½ä¼ è¾“é”™è¯¯çš„æœºç‡

æ ¹æ®ä¸Šé¢çš„Polybiusæ–¹é˜µå°†å¯¹åº”çš„æ˜æ–‡è¿›è¡ŒåŠ å¯†ã€‚å…¶ä¸­ï¼ŒA,D,F,G,Xä¹Ÿå¯ä»¥ç”¨æ•°å­—1,2,3,4,5æ¥ä»£æ›¿ï¼Œè¿™æ ·å¯†æ–‡å°±æˆäº†ï¼š

| æ˜æ–‡ | A    | T    | T    | A    | C    | K    | A    | T    | O    | N    | C    | E    |
| :--- | :--- | :--- | :--- | :--- | :--- | :--- | :--- | :--- | :--- | :--- | :--- | :--- |
| å¯†æ–‡ | AF   | AD   | AD   | AF   | GF   | DX   | AF   | AD   | DF   | FX   | GF   | XF   |
|      | 13   | 12   | 12   | 13   | 43   | 25   | 13   | 12   | 23   | 35   | 43   | 53   |

------



æˆ‘ä»¬æ¥åˆ†æé¢˜ç›®

> å¯†æ–‡ï¼šouauuuoooeeaaiaeauieuooeeiea
>
> hint: VGhlIGxlbmd0aCBvZiB0aGlzIHBsYWludGV4dDogMTQ=

åŸºæœ¬çš„è§£é¢˜æ–¹é˜µå¦‚ä¸‹

![image-20241106213917475](https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202411062139543.png)

base64è§£å¯†åä¿¡æ¯ä¸º`The length of this plaintext: 14`ï¼Œæç¤ºé•¿åº¦ä¸º14ï¼Œä½†æ˜¯a,e,o,i,uè¿™äº”ä¸ªå­—ç¬¦çš„ä»£è¡¨é¡ºåºå´ä¸çŸ¥é“,å› æ­¤å¯èƒ½æœ‰5*4*3*2*1ç§æƒ…å†µ,åœ¨ç»“åˆåˆšæ‰æ‰€è¯´çš„i,jåŒæ—¶å ä¸€ä¸ªä½ç½®,æ‰€ä»¥æƒ…å†µæ•°è¦å†ä¹˜ä¸Š2,å°†è¿™äº›æƒ…å†µå…¨éƒ¨éƒ½æ‰“å°å‡ºæ¥,ç„¶åå»æ‰¾æœ‰çœŸå®è¯­ä¹‰çš„å¥å­å°±å¯ä»¥äº†.æ‰€ä»¥å¯†æ–‡ä¸º14Ã—2ä½ï¼Œå¯ä»¥æ¨æµ‹ä¸ºæ³¢åˆ©æ¯”å¥¥æ–¯æ–¹é˜µå¯†ç 

```python
import itertools
ciper = 'ouauuuoooeeaaiaeauieuooeeiea'
head = 'aeoiu'
headlist = []
num_headlist = []

# å…ˆåˆ—ä¸¾å¤„aeiouäº”ç§çš„ä¸åŒæ’åº
x = itertools.permutations(head,5)
for i in x:
    temp = "".join(i)
    headlist.append(temp)
print(headlist)

# æ ¹æ®aeiouå¯¹åº”çš„12345ä¿®æ”¹ciperçš„å¯¹åº”å€¼ï¼Œä¾¿äºåç»­çš„éå†å¾—åˆ°ç»“æœ
for i in headlist:
    temp = ''
    for j in ciper:
        temp += str(i.index(j) + 1)        
    num_headlist.append(temp)
print(num_headlist)

# å°†ciperå¯¹åº”çš„æ•°å­—ä¹˜ä¸Šæ¯”ä¾‹åŠ ä¸Š96å†è½¬ä¸ºASCIIç ï¼Œå³ å¯å¾—åˆ°å¯¹åº”çš„å­—æ¯
for i in num_headlist:
    temp = ''
    for j in range(0,len(i),2):
        xx = (int(i[j]) - 1)*5 + int(i[j+1]) + 96   # å‰ä¸€ä¸ªä¸ºä¹˜ä¸Š5åŠ ä¸Šåä¸€ä¸ªå°±æ­£å¥½å¯¹åº”äº†è¡¨æ ¼ä¸­çš„å­—æ¯
        if xx>ord('i'):
            xx+=1
        temp += chr(xx)
    print(temp)
```

https://www.cnblogs.com/labster/p/13842837.html



### å››é¢å…«æ–¹ï¼ˆå››æ–¹å¯†ç ï¼‰

æ ¹æ®é¢˜ç›®æç¤ºï¼Œè¯¥é¢˜è€ƒçš„æ˜¯å››æ–¹å¯†ç 

å››æ–¹å¯†ç ç”¨4ä¸ª5Ã—5çš„çŸ©é˜µæ¥åŠ å¯†ã€‚æ¯ä¸ªçŸ©é˜µéƒ½æœ‰25ä¸ªå­—æ¯ï¼ˆé€šå¸¸ä¼šå–æ¶ˆQæˆ–å°†I,Jè§†ä½œåŒä¸€æ ·ï¼Œæˆ–æ”¹è¿›ä¸º6Ã—6çš„çŸ©é˜µï¼ŒåŠ å…¥10ä¸ªæ•°å­—ï¼‰ã€‚

åŠ å¯†åŸç†ï¼š

é¦–å…ˆé€‰æ‹©ä¸¤ä¸ªè‹±æ–‡å­—ä½œå¯†åŒ™ï¼Œä¾‹å¦‚exampleå’Œkeywordã€‚å¯¹äºæ¯ä¸€ä¸ªå¯†åŒ™ï¼Œå°†é‡å¤å‡ºç°çš„å­—æ¯å»é™¤ï¼Œå³exampleè¦è½¬æˆexamplï¼Œç„¶åå°†æ¯ä¸ªå­—æ¯é¡ºåºæ”¾å…¥çŸ©é˜µï¼Œå†å°†ä½™ä¸‹çš„å­—æ¯é¡ºåºæ”¾å…¥çŸ©é˜µï¼Œä¾¿å¾—å‡ºåŠ å¯†çŸ©é˜µã€‚

å°†è¿™ä¸¤ä¸ªåŠ å¯†çŸ©é˜µæ”¾åœ¨å³ä¸Šè§’å’Œå·¦ä¸‹è§’ï¼Œä½™ä¸‹çš„ä¸¤ä¸ªè§’æ”¾aåˆ°zé¡ºåºçš„çŸ©é˜µï¼š [1]

åŠ å¯†çš„æ­¥éª¤ï¼š

ä¸¤ä¸ªå­—æ¯ä¸€ç»„åœ°åˆ†å¼€è®¯æ¯ï¼šï¼ˆä¾‹å¦‚hello worldå˜æˆhe ll ow or ldï¼‰ï¼›

æ‰¾å‡ºç¬¬ä¸€ä¸ªå­—æ¯åœ¨å·¦ä¸Šè§’çŸ©é˜µçš„ä½ç½®ï¼›

åŒæ ·é“ç†ï¼Œæ‰¾ç¬¬äºŒä¸ªå­—æ¯åœ¨å³ä¸‹è§’çŸ©é˜µçš„ä½ç½®ï¼›

æ‰¾å³ä¸Šè§’çŸ©é˜µä¸­ï¼Œå’Œç¬¬ä¸€ä¸ªå­—æ¯åŒè¡Œï¼Œç¬¬äºŒä¸ªå­—æ¯åŒåˆ—çš„å­—æ¯ï¼›

æ‰¾å·¦ä¸‹è§’çŸ©é˜µä¸­ï¼Œå’Œç¬¬ä¸€ä¸ªå­—æ¯åŒåˆ—ï¼Œç¬¬äºŒä¸ªå­—æ¯åŒè¡Œçš„å­—æ¯ï¼›

å¾—åˆ°çš„è¿™ä¸¤ä¸ªå­—æ¯å°±æ˜¯åŠ å¯†è¿‡çš„è®¯æ¯ã€‚

he lp me ob iw an ke no biçš„åŠ å¯†ç»“æœï¼šFY NF NE HW BX AF FO KH MD

å¼•ç”¨å¤§ä½¬åšå®¢ä¸­çš„ä¸€å¼ å›¾ç‰‡ï¼š

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://i-blog.csdnimg.cn/blog_migrate/62d1f04915b57dc33e106c3f32afd1a8.png)

å†å›åˆ°æœ¬é¢˜

ç”±key1:securityå’Œ key2:informationå¯ä»¥ç¡®è®¤é˜µå›¾

abcde SECUR

fghij    ITYAB

klmno DFGHJ

prstu KLMNO

vwxyz PVWXZ

INFOR abcde

MATBC fghij

DEGHJ klmno

KLPSU prstu

VWXYZ vwxyz

è¦è§£å¯†çš„å¯†æ–‡ä¸ºzh nj in ho op cf cu kt lj

æŒ‰ç…§åˆšæ‰çš„æ–¹æ³•è§£å¯†ä¸ºï¼šyo un ga nd su cc es sf ul

flag{youngandsuccessful}

ä¹Ÿå¯ä»¥ç”¨è„šæœ¬

æˆ‘ä»¬å¼•ç”¨å¤§ä½¬è„šæœ¬

```python
import collections
import re
 
matrix = 'ABCDEFGHIJKLMNOPRSTUVWXYZ'
pla = 'abcdefghijklmnoprstuvwxyz'
key1 = '[SECURITY]'
key2 = '[INFORMATION]'
key1 = ''.join(collections.OrderedDict.fromkeys(key1))
key2 = ''.join(collections.OrderedDict.fromkeys(key2))
 
matrix1 = re.sub('[\[\]]','',key1) + re.sub(key1,'',matrix)
matrix2 = re.sub('[\[\]]','',key2) + re.sub(key2,'',matrix)
 
matrix_list1 = []
matrix_list2 = []
pla_list = []
for i in range(0,len(matrix1),5):
matrix_list1.append(list(matrix1[i:i+5]))
#print matrix_list1
 
for i in range(0,len(matrix2),5):
matrix_list2.append(list(matrix2[i:i+5]))
#print matrix_list2
 
for i in range(0,len(pla),5):
pla_list.append(list(pla[i:i+5]))
#print pla_list
 
#æŸ¥è¯¢ä¸¤ä¸ªå¯†æ–‡å­—æ¯ä½ç½®
def find_index1(x):
for i in range(len(matrix_list1)):
for j in range(len(matrix_list1[i])):
if matrix_list1[i][j] == x:
return i,j
def find_index2(y):
for k in range(len(matrix_list2)):
for l in range(len(matrix_list2[k])):
if matrix_list2[k][l] == y:
return k,l
 
def gen_pla(letter):
 
#ä¸¤ä¸ªå­æ¯ä¸­ç¬¬ä¸€ä¸ªå­—æ¯ä½ç½®
first = find_index1(letter[0])
 
#ä¸¤ä¸ªå­æ¯ä¸­ç¬¬äºŒä¸ªå­—æ¯ä½ç½®
second = find_index2(letter[1])
 
pla = ''
pla += pla_list[first[0]][second[1]]
pla += pla_list[second[0]][first[1]]
 
return pla
 
def main():
cip = 'ZHNJINHOOPCFCUKTLJ'
pla = ''
for i in range(0,len(cip),2):
pla += gen_pla(cip[i:i+2])
print (pla)
 
if __name__ == '__main__':
main()import collections
import re

matrix = 'ABCDEFGHIJKLMNOPRSTUVWXYZ'
pla = 'abcdefghijklmnoprstuvwxyz'
key1 = '[SECURITY]'
key2 = '[INFORMATION]'
key1 = ''.join(collections.OrderedDict.fromkeys(key1))
key2 = ''.join(collections.OrderedDict.fromkeys(key2))

matrix1 = re.sub('[\[\]]', '', key1) + re.sub(key1, '', matrix)
matrix2 = re.sub('[\[\]]', '', key2) + re.sub(key2, '', matrix)

matrix_list1 = []
matrix_list2 = []
pla_list = []
for i in range(0, len(matrix1), 5):
    matrix_list1.append(list(matrix1[i:i + 5]))
# print matrix_list1

for i in range(0, len(matrix2), 5):
    matrix_list2.append(list(matrix2[i:i + 5]))
# print matrix_list2

for i in range(0, len(pla), 5):
    pla_list.append(list(pla[i:i + 5]))


# print pla_list

# æŸ¥è¯¢ä¸¤ä¸ªå¯†æ–‡å­—æ¯ä½ç½®
def find_index1(x):
    for i in range(len(matrix_list1)):
        for j in range(len(matrix_list1[i])):
            if matrix_list1[i][j] == x:
                return i, j


def find_index2(y):
    for k in range(len(matrix_list2)):
        for l in range(len(matrix_list2[k])):
            if matrix_list2[k][l] == y:
                return k, l


def gen_pla(letter):


# ä¸¤ä¸ªå­æ¯ä¸­ç¬¬ä¸€ä¸ªå­—æ¯ä½ç½®
    first = find_index1(letter[0])

    # ä¸¤ä¸ªå­æ¯ä¸­ç¬¬äºŒä¸ªå­—æ¯ä½ç½®
    second = find_index2(letter[1])

    pla = ''
    pla += pla_list[first[0]][second[1]]
    pla += pla_list[second[0]][first[1]]

    return pla


def main():
    cip = 'ZHNJINHOOPCFCUKTLJ' //å¯†æ–‡


    pla = ''
    for i in range(0, len(cip), 2):
        pla += gen_pla(cip[i:i + 2])
    print(pla)

if __name__ == '__main__':
    main()
```



### [ACTFæ–°ç”Ÿèµ›2020]crypto-classic1(é”®ç›˜åŒ…å›´å¯†ç &ç»´å‰å°¼äºš)

é¦–å…ˆæ˜¯ä¸ª26é”®é”®ç›˜åŒ…å›´å¯†ç è§£å¯†ï¼Œå¾—åˆ°å‹ç¼©åŒ…å¯†ç circle

è§£å‹ï¼Œå¾—åˆ°ç»´å‰å°¼äºšå¯†ç 

```
SRLU{LZPL_S_UASHKXUPD_NXYTFTJT}
```

å†åˆ©ç”¨[è„šæœ¬](https://blog.csdn.net/hengdonghui/article/details/142381747?utm_medium=distribute.pc_relevant.none-task-blog-2~default~baidujs_baidulandingword~default-0-142381747-blog-108207138.235^v43^pc_blog_bottom_relevance_base6&spm=1001.2101.3001.4242.1&utm_relevant_index=3)

```
# coding=utf-8

# é€šè¿‡å‰4ä¸ªå­—æ¯ï¼Œè®¡ç®—å‡ºkey:
s1 = 'SRLU'
s2 = 'ACTF'
key = ''
for i in range(4):
    key += chr((ord(s1[i])-ord(s2[i]))%26 + ord('A'))
print(key)
l = len(key)
print(l)
# key='SPSP'
# 4

c = 'SRLU{LZPL_S_UASHKXUPD_NXYTFTJT}'
m = []
l_c = len(c)
for i in range(l_c):
    if 'A'<=c[i]<='Z':
        if ord(c[i]) < ord(key[i % l]):
            m.append(chr(ord(c[i]) - ord(key[i % l]) + ord('A') + 26))
        else:
            m.append(chr(ord(c[i]) - ord(key[i % l]) + ord('A')))
    else:
        m.append(c[i])
print(m)

l = len(m)
flag = ''
for i in range(l):
    flag += m[i]
print(flag.lower())

```

### EasyProgramï¼ˆä¼ªä»£ç ï¼‰

![image-20241119215705588](https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202411192157656.png)

çœ‹äº†ä¸‹ï¼Œæ²¡çœ‹æ‡‚å•¥è¯­è¨€ï¼Œåº”è¯¥æ˜¯ä¼ªä»£ç å§ï¼Œè¿™é“é¢˜çš„flagçš„åŠ å¯†å…¶å®å°±ä¸€å¥è¯

```
    set flag[m]:flag[m]^s[x]
```

è¦é€†å‘å¾ˆç®€å•

```python
#è¯»æ–‡ä»¶æ–¹æ³•ä¸€ï¼š
def filehex(file):
    fhex=[]
    f = open(file,'rb')
    ff = f.read().hex()
 
    for i in range(0,len(str(ff)),2):
        fhex.append(int(str(ff)[i:i+2],16))
    return fhex
 
flagx2=filehex('file.txt')
print(flagx2)
 
#è¯»æ–‡ä»¶æ–¹æ³•äºŒï¼šä½¿ç”¨010edit è¯»å–'file.txt'æ–‡ä»¶16è¿›åˆ¶
flagx=[0x00,0xBA,0x8F,0x11,0x2B,0x22,0x9F,0x51,0xA1,0x2F,0xAB,0xB7,0x4B,0xD7,0x3F,0xEF,0xE1,0xB5,0x13,0xBE,0xC4,0xD4,0x5D,0x03,0xD9,0x00,0x7A,0xCA,0x1D,0x51,0xA4,0x73,0xB5,0xEF,0x3D,0x9B,0x31,0xB3]
 
s=[]
t=[]
key='whoami'
j=0
for i in range(0,256):
    s.append(i)
 
for i in range(0,256):
    t.append(key[i % len(key)])
 
for i in range(0,256):
     j=(j+int(s[i])+int(ord(t[i])))%256
     s[i], s[j] = s[j], s[i]
 
i=0;j=0;x=0
for m in range(0,38):
    i=(i + 1)%(256)
    j=(j + s[i])%(256)
    s[i],s[j] = s[j],s[i]
    x=(s[i] + (s[j]%(256)))%(256)
    flagx[m] = flagx[m] ^ s[x]
    flagx2[m]=flagx2[m]^s[x]
 
print(''.join(chr(flagx[i]) for i in range(0,38)))
print(''.join(chr(flagx2[i]) for i in range(0,38)))
```

### [GUET-CTF2019]NO SOS(å‡¯æ’’å¯†ç ï¼ŒåŸ¹æ ¹å¯†ç )

ä¸€çœ¼çœ‹å»æ˜¯æ‘©æ–¯å¯†ç ï¼Œä½†æœ‰ç‚¹é”™è¯¯

æˆ‘ä»¬å…ˆä¿®æ­£ï¼Œå¾—åˆ°

```
..-.-.-.--.......--..-...-..-...--.-.-....-..-..--.-.-..-.-..----
```

è§£ç åå¾—åˆ°

```
aababababbaaaaaaabbaabaaabaabaaabbababaaaabaabaabbababaababaabbbb
```

çœ‹åˆ°å­—ç¬¦ä¸²é‡Œåªå«æœ‰abï¼Œæˆ‘ä»¬æƒ³åˆ°åŸ¹æ ¹å¯†ç 

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://i-blog.csdnimg.cn/blog_migrate/0c26baebb6b942b12a001daf9a318dec.png)

è§£å¯†å¾—åˆ°flag

![image-20241202210024381](https://insey.oss-cn-shenzhen.aliyuncs.com/kin/202412022100603.png)

### [UTCTF2020]hill(å¸Œå°”å¯†ç )

[å¸Œå°”å¯†ç ](https://baike.baidu.com/item/å¸Œå°”å¯†ç /2250150?fromtitle=Hillå¯†ç &fromid=1435959&fr=aladdin)

æ¯ä¸ªå­—æ¯å½“ä½œ26è¿›åˆ¶æ•°å­—ï¼šA=0, B=1, C=2â€¦ ä¸€ä¸²å­—æ¯å½“æˆnç»´å‘é‡ï¼Œè·Ÿä¸€ä¸ªnÃ—nçš„çŸ©é˜µç›¸ä¹˜ï¼Œå†å°†å¾—å‡ºçš„ç»“æœæ¨¡26ã€‚

æ³¨æ„ç”¨ä½œåŠ å¯†çš„çŸ©é˜µï¼ˆå³å¯†åŒ™ï¼‰åœ¨

![[å¤–é“¾å›¾ç‰‡è½¬å­˜å¤±è´¥,æºç«™å¯èƒ½æœ‰é˜²ç›—é“¾æœºåˆ¶,å»ºè®®å°†å›¾ç‰‡ä¿å­˜ä¸‹æ¥ç›´æ¥ä¸Šä¼ (img-35afbMB0-1627306365129)(https://bkimg.cdn.bcebos.com/formula/1af1cfeb705030c3fd09342022a87f9d.svg)]](https://img-blog.csdnimg.cn/c755e38ef92d4424bb27046d40d05d3b.png)

å¿…é¡»æ˜¯å¯é€†çš„ï¼Œå¦åˆ™å°±ä¸å¯èƒ½è§£ç ã€‚åªæœ‰çŸ©é˜µçš„è¡Œåˆ—å¼å’Œ26äº’è´¨ï¼Œæ‰æ˜¯å¯é€†çš„ã€‚

è¿™é¢˜å°±æ˜¯ä¸ªäºŒé˜¶å¸Œå°”å¯†ç åŠ å¯†ã€‚çŸ¥é“å¯†æ–‡å‰6ä½wznqcaå’Œæ˜æ–‡å‰6ä½utflagï¼Œç­‰äº4ä¸ªæœªçŸ¥æ•°6ä¸ªä¸€é˜¶æ–¹ç¨‹ï¼Œå±…ç„¶è¿˜æœ‰è§£ï¼Œé‚£å°±æ˜¯äºŒé˜¶è·‘ä¸äº†äº†ã€‚

ç„¶åæ ¹æ® wznqca = utflag è§£å‡ºABCD (æ˜¯mod26æ„ä¹‰ä¸‹çš„ï¼)

```py
from string import *
s = "duqopfkqnwofdbzgeu"

def Find(a1,a2,a3,a4,a5,a6,b1,b2,b3,b4,b5,b6):
    for c1 in range(26):
        for c2 in range(26):
            for c3 in range(26):
                for c4 in range(26):
                    if(((c1*a1+c2*a4)%26 == b1) and ((c1*a2+c2*a5)%26 == b2) and ((c1*a3+c2*a6)%26 == b3) \
                    and((c3*a1+c4*a4)%26 == b4) and ((c3*a2+c4*a5)%26 == b5) and ((c3*a3+c3*a6)%26 == b6)):
                        return (c1,c2,c3,c4)

c = Find(22,13,2,25,16,0,20,5,0,19,11,6)
A,C,B,D = c[0],c[1],c[2],c[3]
flag = ""
for i in range(0,len(s),2):
    flag += ascii_letters[(A*ascii_letters.index(s[i])+C*ascii_letters.index(s[i+1]))%26]
    flag += ascii_letters[(B*ascii_letters.index(s[i])+D*ascii_letters.index(s[i+1]))%26]

print(flag)
# d4nger0us_c1pherText_qq
# d4uqop0fk_q1nwofDbzg_eu


```

### [AFCTF2018]ä½ å¬è¿‡ä¸€æ¬¡ä¸€å¯†ä¹ˆï¼Ÿ(ä¸€æ¬¡ä¸€å¯†åŠ å¯†)

è½¬è½½https://www.ruanx.net/many-time-pad/

buué™„ä»¶æœ‰é—®é¢˜ï¼Œåº”è¯¥ä¸º

```
25030206463d3d393131555f7f1d061d4052111a19544e2e5d54
0f020606150f203f307f5c0a7f24070747130e16545000035d54
1203075429152a7020365c167f390f1013170b1006481e13144e
0f4610170e1e2235787f7853372c0f065752111b15454e0e0901
081543000e1e6f3f3a3348533a270d064a02111a1b5f4e0a1855
0909075412132e247436425332281a1c561f04071d520f0b1158
4116111b101e2170203011113a69001b47520601155205021901
041006064612297020375453342c17545a01451811411a470e44
021311114a5b0335207f7c167f22001b44520c15544801125d40
06140611460c26243c7f5c167f3d015446010053005907145d44
0f05110d160f263f3a7f4210372c03111313090415481d49530f
```

ã€€æœ¬æ–‡è®¨è®ºçš„åŠ å¯†æ–¹å¼æ˜¯æœ€ç®€å•çš„ä¸€ç§ï¼šç®€å•å¼‚æˆ–ã€‚å‡†å¤‡ä¸€ä¸ª `key` å­—ç¬¦ä¸²ï¼Œç„¶ååˆ©ç”¨ `key` å»å¼‚æˆ–ç›¸åŒé•¿åº¦çš„æ˜æ–‡ï¼Œå³å¾—åˆ°å¯†æ–‡ã€‚å¦‚æœæ¯ä¸ªå¯†æ–‡éƒ½åˆ©ç”¨æ–°çš„ `key` å»åŠ å¯†ï¼Œé‚£ä¹ˆè¿™ç§æ–¹å¼ç§°ä¸º**â€œä¸€æ¬¡ä¸€å¯†â€ï¼ˆOne-Time-Padï¼‰**ã€‚OTPæ˜¯æ— æ¡ä»¶å®‰å…¨çš„ï¼šå³ä½¿æ”»å‡»è€…æ‹¥æœ‰æ— é™çš„è®¡ç®—èµ„æºï¼Œéƒ½ä¸å¯èƒ½ç ´è¯‘OTPåŠ å¯†çš„å¯†æ–‡ã€‚

ã€€ã€€ç„¶è€Œï¼Œä¸€æ¬¡ä¸€å¯†çš„å¯†é’¥åˆ†å‘æ˜¯æ¯”è¾ƒå›°éš¾çš„ã€‚é¦–å…ˆï¼ŒAlice æƒ³è¦ ç»™ Bob å‘é€é•¿åº¦ä¸º n çš„ä¿¡æ¯ï¼Œåˆ™å¿…é¡»åœ¨è¿™ä¹‹å‰ä¼ é€é•¿åº¦ä¸º n çš„å¯†é’¥ï¼Œç›¸å½“äºä¼ è¾“çš„æ•°æ®æ€»é‡ç¿»äº†å€ã€‚å…¶æ¬¡ï¼Œå°½ç®¡å¯†æ–‡æ˜¯æ— æ¡ä»¶å®‰å…¨çš„ï¼Œä½†å¯†é’¥çš„ä¼ è¾“ä¿¡é“æœªå¿…æ˜¯å®‰å…¨çš„ï¼Œæ”»å‡»è€…ä¸€æ—¦çªƒå¬äº†å¯†é’¥ï¼Œåˆ™å¯ä»¥è§£å¯†å¯†æ–‡ã€‚

ã€€ã€€é‚£ä¹ˆé©¬ä¸Šå°±å¯ä»¥æƒ³åˆ°ä¸€ä¸ªæŠ•æœºå–å·§çš„æ–¹æ³•â€”â€” Alice é€ ä¸€ä¸ªæ¯”è¾ƒé•¿çš„å¯†é’¥ï¼Œç„¶åç”¨éå¸¸ç§˜å¯†çš„æ–¹å¼å‘Šè¯‰ Bob. æ¥ä¸‹æ¥ï¼ŒAlice æ¯æ¬¡å‘ Bob å‘é€ä¿¡æ¯ï¼Œéƒ½æŠŠæ˜æ–‡å¼‚æˆ–ä¸Šè¿™ä¸ªçº¦å®šå¥½çš„å­—ç¬¦ä¸²ï¼›Bob æ”¶åˆ°ä¿¡æ¯ä¹‹åï¼ŒæŠŠå¯†æ–‡å¼‚æˆ–ä¸Š `key`, äºæ˜¯å°±å¯ä»¥æ‹¿åˆ°æ˜æ–‡ã€‚æ•´ä¸ªè¿‡ç¨‹åªéœ€è¦ä¼ é€ä¸€æ¬¡å¯†é’¥ï¼Œè¿™æ˜¯å¾ˆæ–¹ä¾¿çš„ã€‚è¿™ç§æ–¹å¼ç§°ä¸º Many-Time-Pad (MTP).

ã€€ã€€å¾ˆé—æ†¾ï¼Œä¸Šè¿°çš„ MTP åŠæ³•æ˜¯ä¸å®‰å…¨çš„ã€‚æ”»å‡»è€…å¦‚æœæˆªè·äº†è¶³å¤Ÿå¤šçš„å¯†æ–‡ï¼Œå°±æœ‰å¯èƒ½æ¨æ–­å‡ºæ˜æ–‡ã€è¿›è€Œæ‹¿åˆ°å¯†é’¥ã€‚è¿™ä¸ªç¼ºé™·æ˜¯å¼‚æˆ–è¿ç®—çš„æ€§è´¨å¸¦æ¥çš„ã€‚

ã€€ä¸Šè¿°çš„æ¯ä¸€ä¸ªå­—ç¬¦ä¸² Ciï¼Œéƒ½æ˜¯æŸä¸ª `key` å¼‚æˆ–ä¸Šæ˜æ–‡ Mi å¾—åˆ°çš„ã€‚æˆ‘ä»¬çš„ç›®æ ‡æ˜¯è·å–è¿™ä¸ª `key`. **å·²çŸ¥æ˜æ–‡æ˜¯è‹±æ–‡å¥å­**ã€‚

ã€€ã€€å›é¡¾å¼‚æˆ–è¿ç®—çš„æ€§è´¨ï¼šç»“åˆå¾‹ã€äº¤æ¢å¾‹ã€é€†å…ƒä¸ºå…¶è‡ªèº«ã€‚è¿™æ˜¯éå¸¸å¥½çš„æ€§è´¨ï¼Œç„¶è€Œä¹Ÿä¸ºæ”»å‡»è€…æä¾›äº†æ–¹ä¾¿ã€‚å› ä¸ºï¼š

C1âŠ•C2=(M1âŠ•key)âŠ•(M2âŠ•key)=M1âŠ•M2

ã€€ã€€è¿™è¡¨æ˜ï¼Œä¸¤ä¸ªå¯†æ–‡çš„å¼‚æˆ–ï¼Œå°±ç­‰äºå¯¹åº”æ˜æ–‡çš„å¼‚æˆ–ã€‚è¿™æ˜¯å¾ˆå±é™©çš„æ€§è´¨ï¼Œé«˜æ˜çš„æ”»å‡»è€…å¯ä»¥é€šè¿‡é¢‘ç‡åˆ†æï¼Œæ¥ç ´è¯‘è¿™äº›å¯†æ–‡ã€‚æˆ‘ä»¬æ¥çœ‹å­—ç¬¦ä¸² C1 å¼‚æˆ–ä¸Šå…¶ä»–å¯†æ–‡ä¼šå¾—åˆ°ä»€ä¹ˆä¸œè¥¿ã€‚ä»¥ä¸‹åªä¿ç•™äº†è‹±æ–‡å­—ç¬¦ï¼Œå…¶ä½™å­—ç¬¦ä»¥ â€œ.â€ ä»£æ›¿ã€‚

è¿™è¡¨æ˜ï¼Œä¸¤ä¸ªå¯†æ–‡çš„å¼‚æˆ–ï¼Œå°±ç­‰äºå¯¹åº”æ˜æ–‡çš„å¼‚æˆ–ã€‚è¿™æ˜¯å¾ˆå±é™©çš„æ€§è´¨ï¼Œé«˜æ˜çš„æ”»å‡»è€…å¯ä»¥é€šè¿‡é¢‘ç‡åˆ†æï¼Œæ¥ç ´è¯‘è¿™äº›å¯†æ–‡ã€‚æˆ‘ä»¬æ¥çœ‹å­—ç¬¦ä¸² C1 å¼‚æˆ–ä¸Šå…¶ä»–å¯†æ–‡ä¼šå¾—åˆ°ä»€ä¹ˆä¸œè¥¿ã€‚ä»¥ä¸‹åªä¿ç•™äº†è‹±æ–‡å­—ç¬¦ï¼Œå…¶ä½™å­—ç¬¦ä»¥ â€œ.â€ ä»£æ›¿ã€‚

```shell
....S....N.U.....A..M.N...
...Ro..I...I....SE....P.I.
.E..H...IN..H...........TU
..A.H.R.....E....P......E.
...RT...E...M....M....A.L.
d...V..I..DNEt........K.DU
.......I....K..I.ST...TiS.
.....f...N.I........M.O...
.........N.I...I.S.I..I...
....P....N.OH...SA....Sg..
```

ã€€ã€€å¯ä»¥è§‚å¯Ÿåˆ°ï¼Œæœ‰äº›åˆ—ä¸Šæœ‰å¤§é‡çš„è‹±æ–‡å­—ç¬¦ï¼Œæœ‰äº›åˆ—ä¸€ä¸ªè‹±æ–‡å­—ç¬¦éƒ½æ²¡æœ‰ã€‚è¿™æ˜¯å¶ç„¶ç°è±¡å—ï¼Ÿ

#### asciiè¡¨

ã€€ã€€ascii ç è¡¨åœ¨ Linux ä¸‹å¯ä»¥é€šè¿‡ `man ascii` æŒ‡ä»¤æŸ¥çœ‹ã€‚å®ƒçš„æ€§è´¨æœ‰ï¼š

- `0x20` æ˜¯ç©ºæ ¼ã€‚ ä½äº `0x20` çš„ï¼Œå…¨éƒ¨æ˜¯èµ·ç‰¹æ®Šç”¨é€”çš„å­—ç¬¦ï¼› `0x20~0x7E` çš„ï¼Œæ˜¯å¯æ‰“å°å­—ç¬¦ã€‚
- `0x30~0x39` æ˜¯æ•°å­— `0,1,2...9`ã€‚
- `0x41~0x5A` æ˜¯å¤§å†™å­—æ¯ `A-Z`ï¼› `0x61~0x7A` æ˜¯å°å†™å­—æ¯ `a-z`.

ã€€ã€€æˆ‘ä»¬å¯ä»¥æ³¨æ„åˆ°ä¸€ä¸ªè‡³å…³é‡è¦çš„è§„å¾‹ï¼šå°å†™å­—æ¯ xor ç©ºæ ¼ï¼Œä¼šå¾—åˆ°å¯¹åº”çš„å¤§å†™å­—æ¯ï¼›å¤§å†™å­—æ¯ xor ç©ºæ ¼ï¼Œä¼šå¾—åˆ°å°å†™å­—æ¯ï¼æ‰€ä»¥ï¼Œå¦‚æœ xâŠ•y å¾—åˆ°ä¸€ä¸ªè‹±æ–‡å­—æ¯ï¼Œé‚£ä¹ˆ x,y ä¸­çš„æŸä¸€ä¸ªæœ‰å¾ˆå¤§æ¦‚ç‡æ˜¯ç©ºæ ¼ã€‚å†æ¥å›å¤´çœ‹ä¸Šé¢ C1 xor å…¶ä»–å¯†æ–‡â€”â€”ä¹Ÿå°±ç­‰äº M1 xor å…¶ä»–æ˜æ–‡çš„è¡¨ï¼Œå¦‚æœç¬¬ col åˆ—å­˜åœ¨å¤§é‡çš„è‹±æ–‡å­—æ¯ï¼Œæˆ‘ä»¬å¯ä»¥çŒœæµ‹ M1[col] æ˜¯ä¸€ä¸ªç©ºæ ¼ã€‚é‚£ä¸€åˆ—è‹±æ–‡å­—æ¯è¶Šå¤šï¼ŒæŠŠæ¡è¶Šå¤§ã€‚

ã€€ã€€çŸ¥é“ M1 çš„ col ä½æ˜¯ç©ºæ ¼æœ‰ä»€ä¹ˆç”¨å‘¢ï¼Ÿåˆ«å¿˜äº†å¼‚æˆ–è¿ç®—ä¸‹ï¼Œx çš„é€†å…ƒæ˜¯å…¶è‡ªèº«ã€‚æ‰€ä»¥Mi[col]=M1[col]âŠ•Mi[col]âŠ•M1[col]=M1[col]âŠ•Mi[col]âŠ•0x20

ã€€ã€€äºæ˜¯ï¼Œåªè¦çŸ¥é“æŸä¸ªå­—ç¬¦ä¸²çš„æŸä¸€ä½æ˜¯ç©ºæ ¼ï¼Œæˆ‘ä»¬å°±å¯ä»¥æ¢å¤å‡ºæ‰€æœ‰æ˜æ–‡åœ¨è¿™ä¸€åˆ—çš„å€¼ã€‚

#### æ”»å‡»

ã€€ã€€æ”»å‡»è¿‡ç¨‹æ˜¾è€Œæ˜“è§ï¼šå¯¹äºæ¯ä¸€æ¡å¯†æ–‡Ciï¼Œæ‹¿å»å¼‚æˆ–å…¶ä»–æ‰€æœ‰å¯†æ–‡ã€‚ç„¶åå»æ•°æ¯ä¸€åˆ—æœ‰å¤šå°‘ä¸ªè‹±æ–‡å­—ç¬¦ï¼Œä½œä¸ºâ€œMiåœ¨è¿™ä¸€ä½æ˜¯ç©ºæ ¼â€çš„è¯„åˆ†ã€‚

ã€€ã€€ä¸Šé¢çš„äº‹æƒ…åšå®Œæ—¶å€™ï¼Œä¾æ®è¯„åˆ†ä»å¤§åˆ°å°æ’åºï¼Œä¾æ¬¡åˆ©ç”¨ â€œæŸä¸ªæ˜æ–‡çš„æŸä¸€ä½æ˜¯ç©ºæ ¼â€ è¿™ç§ä¿¡æ¯æ¢å¤å‡ºæ‰€æœ‰æ˜æ–‡çš„é‚£ä¸€åˆ—ã€‚å¦‚æœäº§ç”Ÿå†²çªï¼Œåˆ™èˆå¼ƒæ‰è¯„åˆ†å°çš„ã€‚ä¸éš¾å†™å‡ºä»£ç ï¼š

```python
import Crypto.Util.strxor as xo
import libnum, codecs, numpy as np

def isChr(x):
    if ord('a') <= x and x <= ord('z'): return True
    if ord('A') <= x and x <= ord('Z'): return True
    return False

def infer(index, pos):
    if msg[index, pos] != 0:
        return
    msg[index, pos] = ord(' ')
    for x in range(len(c)):
        if x != index:
            msg[x][pos] = xo.strxor(c[x], c[index])[pos] ^ ord(' ')

dat = []

def getSpace():
    for index, x in enumerate(c):
        res = [xo.strxor(x, y) for y in c if x!=y]
        f = lambda pos: len(list(filter(isChr, [s[pos] for s in res])))
        cnt = [f(pos) for pos in range(len(x))]
        for pos in range(len(x)):
            dat.append((f(pos), index, pos))

c = [codecs.decode(x.strip().encode(), 'hex') for x in open('Problem.txt', 'r').readlines()]

msg = np.zeros([len(c), len(c[0])], dtype=int)

getSpace()

dat = sorted(dat)[::-1]
for w, index, pos in dat:
    infer(index, pos)

print('\n'.join([''.join([chr(c) for c in x]) for x in msg]))
```

ã€€ã€€æ‰§è¡Œä»£ç ï¼Œå¾—åˆ°çš„ç»“æœæ˜¯ï¼š

```shell
Dear Friend, T%is tim< I u
nderstood my m$stake 8nd u
sed One time p,d encr ptio
n scheme, I he,rd tha- it 
is the only en.ryptio7 met
hod that is ma9hemati:ally
 proven to be #ot cra:ked 
ever if the ke4 is ke)t se
cure, Let Me k#ow if  ou a
gree with me t" use t1is e
ncryption sche e alwa s...
```

ã€€ã€€æ˜¾ç„¶è¿™ä¸æ˜¯æœ€ç»ˆç»“æœï¼Œæˆ‘ä»¬å¾—ä¿®æ­£å‡ é¡¹ã€‚æŠŠ "k#now" ä¿®å¤æˆ "know"ï¼ŒæŠŠ "alwa s" ä¿®å¤æˆ "always". ä»£ç å¦‚ä¸‹ï¼š

```python
def know(index, pos, ch):
    msg[index, pos] = ord(ch)
    for x in range(len(c)):
        if x != index:
            msg[x][pos] = xo.strxor(c[x], c[index])[pos] ^ ord(ch)

know(10, 21, 'y')
know(8, 14, 'n')

print('\n'.join([''.join([chr(c) for c in x]) for x in msg]))
```

ã€€ã€€ç»“æœå¾—åˆ°ï¼š

```shell
Dear Friend, This time I u
nderstood my mistake and u
sed One time pad encryptio
n scheme, I heard that it 
is the only encryption met
hod that is mathematically
 proven to be not cracked 
ever if the key is kept se
cure, Let Me know if you a
gree with me to use this e
ncryption scheme always...
```

ã€€ã€€æˆ‘ä»¬æˆåŠŸæ¢å¤äº†æ˜æ–‡ï¼é‚£ä¹ˆ `key` ä¹Ÿå¾ˆå¥½å–å¾—äº†ï¼šæŠŠ C1 å¼‚æˆ–ä¸Š M1 å³å¯ã€‚

```python
key = xo.strxor(c[0], ''.join([chr(c) for c in msg[0]]).encode())
print(key)

# b'afctf{OPT_1s_Int3rest1ng}!'
```

#### ç»“è®º

ã€€ã€€Many-Time-Pad æ˜¯ä¸å®‰å…¨çš„ã€‚æˆ‘ä»¬è¿™ä¸€æ¬¡çš„æ”»å‡»ï¼Œæ¡ä»¶ç¨å¾®æœ‰ç‚¹è‹›åˆ»ï¼šæ˜æ–‡å¿…é¡»æ˜¯è‹±æ–‡å¥å­ã€æˆªè·åˆ°çš„å¯†æ–‡å¿…é¡»è¶³å¤Ÿå¤šã€‚ä½†æ˜¯åªè¦æ”»å‡»è€…æœ‰è¶³å¤Ÿçš„è€å¿ƒè¿›è¡Œè¯é¢‘åˆ†æã€ç›‘å¬å¤§é‡å¯†æ–‡ï¼Œè¿˜æ˜¯èƒ½å¤Ÿå‘èµ·æå…·å¨èƒæ€§çš„æ”»å‡»ã€‚å¦‚æœé“äº†å¿ƒè¦ç”¨ç›´æ¥xoræ¥åŠ å¯†ä¿¡æ¯ï¼Œåº”å½“é‡‡ç”¨ä¸€æ¬¡ä¸€å¯†(One-Time-Pad).

ã€€ã€€å®Œæ•´çš„è§£é¢˜è„šæœ¬å¦‚ä¸‹ï¼š

```python
import Crypto.Util.strxor as xo
import libnum, codecs, numpy as np

def isChr(x):
    if ord('a') <= x and x <= ord('z'): return True
    if ord('A') <= x and x <= ord('Z'): return True
    return False


def infer(index, pos):
    if msg[index, pos] != 0:
        return
    msg[index, pos] = ord(' ')
    for x in range(len(c)):
        if x != index:
            msg[x][pos] = xo.strxor(c[x], c[index])[pos] ^ ord(' ')

def know(index, pos, ch):
    msg[index, pos] = ord(ch)
    for x in range(len(c)):
        if x != index:
            msg[x][pos] = xo.strxor(c[x], c[index])[pos] ^ ord(ch)


dat = []

def getSpace():
    for index, x in enumerate(c):
        res = [xo.strxor(x, y) for y in c if x!=y]
        f = lambda pos: len(list(filter(isChr, [s[pos] for s in res])))
        cnt = [f(pos) for pos in range(len(x))]
        for pos in range(len(x)):
            dat.append((f(pos), index, pos))

c = [codecs.decode(x.strip().encode(), 'hex') for x in open('Problem.txt', 'r').readlines()]

msg = np.zeros([len(c), len(c[0])], dtype=int)

getSpace()

dat = sorted(dat)[::-1]
for w, index, pos in dat:
    infer(index, pos)

know(10, 21, 'y')
know(8, 14, 'n')

print('\n'.join([''.join([chr(c) for c in x]) for x in msg]))

key = xo.strxor(c[0], ''.join([chr(c) for c in msg[0]]).encode())
print(key)
```

### [BJDCTF2020]ä¼ç¾²å…­åå››å¦

```
è¿™æ˜¯ä»€ä¹ˆï¼Œæ€ä¹ˆçœ‹èµ·æ¥åƒæ˜¯å†ç®—64å¦ï¼ï¼ï¼

å¯†æ–‡:å‡éšä¸´æŸå·½ç½é¢èƒå°è¿‡è®¼è‰®é¢å°è¿‡éœ‡è›Šå±¯æœªæµä¸­å­šè‰®å›°æ’æ™‹å‡æŸè›Šèƒè›Šæœªæµå·½è§£è‰®è´²æœªæµè§‚è±«æŸè›Šæ™‹å™¬å—‘æ™‹æ—…è§£å¤§ç•œå›°æœªæµéšè’™å‡è§£ç½æœªæµäº•å›°æœªæµæ—…èƒæœªæµéœ‡è’™æœªæµå¸ˆæ¶£å½’å¦¹å¤§æœ‰
å—¯ï¼Ÿä¸ºä»€ä¹ˆè¿˜æœ‰ä¸ªbå‘¢?
b=7
flagï¼šè¯·æŒ‰ç…§æ ¼å¼BJD{}
```

```
# -- coding:UTF-8 --
from secret import flag

def encrpyt5():
    enc=''
    for i in flag:
        enc+=chr((a*(ord(i)-97)+b)%26+97)
    return(enc)

def encrypt4():
    temp=''
    offset=5
    for i in range(len(enc)):
        temp+=chr(ord(enc[i])-offset-i)
    return(temp)

```

è„‘æ´æŒºé€†å¤©çš„é¢˜

æˆ‘ä»¬éœ€è¦å°†å¯†æ–‡ä¸­å‡ºç°çš„å¦è±¡æŒ‰ç…§é¡ºåºè½¬åŒ–ä¸º6ä½çš„äºŒè¿›åˆ¶æ•°ï¼Œç„¶åå†åˆ©ç”¨å­—å…¸å°†å¯†æ–‡è½¬åŒ–ä¸ºäºŒè¿›åˆ¶å­—ç¬¦ä¸²

å­—å…¸ï¼ˆä¸æ¸…æ¥šå’‹æ’çš„ï¼‰

```
dic={'å¤': '000000', 'å‰¥': '000001', 'æ¯”': '000010', 'è§‚': '000011', 'è±«': '000100', 'æ™‹': '000101', 'èƒ': '000110', 'å¦': '000111', 'è°¦': '001000', 'è‰®': '001001', 'è¹‡': '001010', 'æ¸': '001011', 'å°è¿‡': '001100', 'æ—…': '001101', 'å’¸': '001110', 'é': '001111', 'å¸ˆ': '010000', 'è’™': '010001', 'å': '010010', 'æ¶£': '010011', 'è§£': '010100', 'æœªæµ': '010101', 'å›°': '010110', 'è®¼': '010111', 'å‡': '011000', 'è›Š': '011001', 'äº•': '011010', 'å·½': '011011', 'æ’': '011100', 'é¼': '011101', 'å¤§è¿‡': '011110', 'å§¤': '011111', 'å¤': '100000', 'é¢': '100001', 'å±¯': '100010', 'ç›Š': '100011', 'éœ‡': '100100', 'å™¬å—‘': '100101', 'éš': '100110', 'æ— å¦„': '100111', 'æ˜å¤·': '101000', 'è´²': '101001', 'æ—¢æµ': '101010', 'å®¶äºº': '101011', 'ä¸°': '101100', 'ç¦»': '101101', 'é©': '101110', 'åŒäºº': '101111', 'ä¸´': '110000', 'æŸ': '110001', 'èŠ‚': '110010', 'ä¸­å­š': '110011', 'å½’å¦¹': '110100', 'ç½': '110101', 'å…‘': '110110', 'å±¥': '110111', 'æ³°': '111000', 'å¤§ç•œ': '111001', 'éœ€': '111010', 'å°ç•œ': '111011', 'å¤§å£®': '111100', 'å¤§æœ‰': '111101', 'å¤¬': '111110', 'ä¹¾': '111111'}
```

ç„¶åæ ¹æ®å­—å…¸å°†å¯†æ–‡è½¬åŒ–ä¸ºäºŒè¿›åˆ¶å­—ç¬¦ä¸²

```python
a = 'å‡éšä¸´æŸå·½ç½é¢èƒå°è¿‡è®¼è‰®é¢å°è¿‡éœ‡è›Šå±¯æœªæµä¸­å­šè‰®å›°æ’æ™‹å‡æŸè›Šèƒè›Šæœªæµå·½è§£è‰®è´²æœªæµè§‚è±«æŸè›Šæ™‹å™¬å—‘æ™‹æ—…è§£å¤§ç•œå›°æœªæµéšè’™å‡è§£ç½æœªæµäº•å›°æœªæµæ—…èƒæœªæµéœ‡è’™æœªæµå¸ˆæ¶£å½’å¦¹å¤§æœ‰'
dic={'å¤': '000000', 'å‰¥': '000001', 'æ¯”': '000010', 'è§‚': '000011', 'è±«': '000100', 'æ™‹': '000101', 'èƒ': '000110', 'å¦': '000111', 'è°¦': '001000', 'è‰®': '001001', 'è¹‡': '001010', 'æ¸': '001011', 'å°è¿‡': '001100', 'æ—…': '001101', 'å’¸': '001110', 'é': '001111', 'å¸ˆ': '010000', 'è’™': '010001', 'å': '010010', 'æ¶£': '010011', 'è§£': '010100', 'æœªæµ': '010101', 'å›°': '010110', 'è®¼': '010111', 'å‡': '011000', 'è›Š': '011001', 'äº•': '011010', 'å·½': '011011', 'æ’': '011100', 'é¼': '011101', 'å¤§è¿‡': '011110', 'å§¤': '011111', 'å¤': '100000', 'é¢': '100001', 'å±¯': '100010', 'ç›Š': '100011', 'éœ‡': '100100', 'å™¬å—‘': '100101', 'éš': '100110', 'æ— å¦„': '100111', 'æ˜å¤·': '101000', 'è´²': '101001', 'æ—¢æµ': '101010', 'å®¶äºº': '101011', 'ä¸°': '101100', 'ç¦»': '101101', 'é©': '101110', 'åŒäºº': '101111', 'ä¸´': '110000', 'æŸ': '110001', 'èŠ‚': '110010', 'ä¸­å­š': '110011', 'å½’å¦¹': '110100', 'ç½': '110101', 'å…‘': '110110', 'å±¥': '110111', 'æ³°': '111000', 'å¤§ç•œ': '111001', 'éœ€': '111010', 'å°ç•œ': '111011', 'å¤§å£®': '111100', 'å¤§æœ‰': '111101', 'å¤¬': '111110', 'ä¹¾': '111111'}
s = ''
i = 0
while i < len(a):
    try:
        s += dic[a[i]]
    except:
        s += dic[a[i] + a[i + 1]]
        i += 1
    i += 1
print(s)
 
#011000100110110000110001011011110101100001000110001100010111001001100001001100100100011001100010010101110011001001010110011100000101011000110001011001000110011001010101011011010100001001101001010101000011000100110001011001000101100101000101001101010100111001010110010101100110010001011000010100110101010101011010010110010101001101000110010101100100010001010101010000010011110100111101
```

ç„¶å8ä¸ªä¸€ç»„è½¬åŒ–ä¸ºå¯è§å­—ç¬¦

```py
s = '011000100110110000110001011011110101100001000110001100010111001001100001001100100100011001100010010101110011001001010110011100000101011000110001011001000110011001010101011011010100001001101001010101000011000100110001011001000101100101000101001101010100111001010110010101100110010001011000010100110101010101011010010110010101001101000110010101100100010001010101010000010011110100111101'
b = ''
for i in range(0, len(s), 8):
    b += chr(int(s[i:i + 8], 2))
print(b)
 
#bl1oXF1ra2FbW2VpV1dfUmBiT11dYE5NVVdXSUZYSFVDUA==
```

å°†å¾—åˆ°çš„ç»“æœè¿›è¡Œbase64è§£å¯†

```
ç»“æœï¼šn]h\]kka[[eiWW_R`bO]]`NMUWWIFXHUCP
```

ç„¶åæ ¹æ®æ‰€ç»™çš„ä¸¤æ¬¡åŠ å¯†ä»£ç è¿›è¡Œé€†å‘

decrypto4

```py
 
s = 'n]h\\]kka[[eiWW_R`bO]]`NMUWWIFXHUCP'
c = ''
for j in range(len(s)):
    c += chr(ord(s[j]) + 5 + j)
print('c = ' + c)
 
#c = scodfuvmhityhirfuxfuvziiruvigzkyhv
```

decrypto5:

```
import gmpy2
 
c = 'scodfuvmhityhirfuxfuvziiruvigzkyhv'
for i in range(1, 27):
    b = ''
    try:
        for j in range(len(c)):
            n = ((ord(c[j]) - 97) - 7) * gmpy2.invert(i, 26) % 26 + 97
            b += chr(n)
        if 'flag' in b:
            print(b)
    except:
        pass
 
#bjdcongratulationsongettingtheflag
```

### [AFCTF2018]MagicNumï¼ˆè®¡ç®—æœºå†…å­˜å‚¨å­˜ï¼‰

```
72065910510177138000000000000000.000000
71863209670811371000000.000000
18489682625412760000000000000000.000000
72723257588050687000000.000000
4674659167469766200000000.000000
19061698837499292000000000000000000000.000000

```

è¿™ä¸ªé¢˜ç›®è€ƒçš„æ˜¯æ•°æ®åœ¨è®¡ç®—æœºå†…å­˜ä¸­çš„å­˜å‚¨ï¼Œéœ€è¦å°†ä¸Šé¢çš„æ•°æ®è½¬æ¢ä¸ºå†…éƒ¨å­˜å‚¨æ¨¡å¼ å†è½¬æ¢ä¸ºäºŒè¿›åˆ¶æ•°æ®ï¼Œå†è½¬æˆå­—èŠ‚ï¼Œå°±èƒ½å¾—åˆ°flagäº†

```
from libnum import*
import struct

s = [72065910510177138000000000000000.000000,71863209670811371000000.000000,18489682625412760000000000000000.000000,72723257588050687000000.000000,4674659167469766200000000.000000,19061698837499292000000000000000000000.000000]
a = ''
b = ''
for i in s:
    i = float(i)
    a += struct.pack('<f',i).hex()        #å°ç«¯
print(a)

for j in s:
    i = float(i)
    b += struct.pack('>f',i).hex()        #å¤§ç«¯
print(b)
a = 0x61666374667b7365635f69735f657665727977686572657d
b = 0x7d6572657d6572657d6572657d6572657d6572657d657265
print(n2s(a))
print(n2s(b))

```

â€‹                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
